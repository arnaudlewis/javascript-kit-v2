(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define("prismic-javascript", [], factory);
	else if(typeof exports === 'object')
		exports["prismic-javascript"] = factory();
	else
		root["prismic-javascript"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 10);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/* unknown exports provided */
/* all exports used */
/*!****************************!*\
  !*** ./src/experiments.ts ***!
  \****************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nexports.__esModule = true;\nvar Variation = (function () {\n    function Variation(data) {\n        this.data = {};\n        this.data = data;\n    }\n    Variation.prototype.id = function () {\n        return this.data.id;\n    };\n    Variation.prototype.ref = function () {\n        return this.data.ref;\n    };\n    Variation.prototype.label = function () {\n        return this.data.label;\n    };\n    return Variation;\n}());\nexports.Variation = Variation;\nvar Experiment = (function () {\n    function Experiment(data) {\n        this.data = {};\n        this.data = data;\n        this.variations = (data.variations || []).map(function (v) {\n            new Variation(v);\n        });\n    }\n    Experiment.prototype.id = function () {\n        return this.data.id;\n    };\n    Experiment.prototype.googleId = function () {\n        return this.data.ref;\n    };\n    Experiment.prototype.name = function () {\n        return this.data.label;\n    };\n    return Experiment;\n}());\nexports.Experiment = Experiment;\nvar Experiments = (function () {\n    function Experiments(data) {\n        if (data) {\n            this.drafts = (data.drafts || []).map(function (exp) {\n                new Experiment(exp);\n            });\n            this.running = (data.running || []).map(function (exp) {\n                new Experiment(exp);\n            });\n        }\n    }\n    Experiments.prototype.current = function () {\n        return this.running.length > 0 ? this.running[0] : null;\n    };\n    Experiments.prototype.refFromCookie = function (cookie) {\n        if (!cookie || cookie.trim() === \"\")\n            return null;\n        var splitted = cookie.trim().split(\" \");\n        if (splitted.length < 2)\n            return null;\n        var expId = splitted[0];\n        var varIndex = parseInt(splitted[1], 10);\n        var exp = this.running.filter(function (exp) {\n            return exp.googleId() == expId && exp.variations.length > varIndex;\n        })[0];\n        return exp ? exp.variations[varIndex].ref() : null;\n    };\n    return Experiments;\n}());\nexports.Experiments = Experiments;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9leHBlcmltZW50cy50cz85MjA2Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBpbnRlcmZhY2UgSUV4cGVyaW1lbnQge1xuICB2YXJpYXRpb25zOiBJVmFyaWF0aW9uW107XG4gIGRhdGE6IGFueTtcblxuICBpZCgpOiBzdHJpbmc7XG4gIGdvb2dsZUlkKCk6IHN0cmluZztcbiAgbmFtZSgpOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVZhcmlhdGlvbiB7XG4gIGRhdGE6IGFueTtcblxuICBpZCgpOiBzdHJpbmc7XG4gIHJlZigpOiBzdHJpbmc7XG4gIGxhYmVsKCk6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJRXhwZXJpbWVudHMge1xuICBkcmFmdHM6IElFeHBlcmltZW50W107XG4gIHJ1bm5pbmc6IElFeHBlcmltZW50W107XG5cbiAgY3VycmVudCgpOiBJRXhwZXJpbWVudCB8IG51bGw7XG4gIHJlZkZyb21Db29raWUoY29va2llOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsO1xufVxuXG5leHBvcnQgY2xhc3MgVmFyaWF0aW9uIGltcGxlbWVudHMgSVZhcmlhdGlvbiB7XG4gIGRhdGE6IGFueSA9IHt9O1xuXG4gIGNvbnN0cnVjdG9yKGRhdGE6IGFueSkge1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gIH1cblxuICBpZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmRhdGEuaWQ7XG4gIH1cblxuICByZWYoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhLnJlZjtcbiAgfVxuXG4gIGxhYmVsKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YS5sYWJlbDtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgRXhwZXJpbWVudCBpbXBsZW1lbnRzIElFeHBlcmltZW50IHtcbiAgdmFyaWF0aW9uczogSVZhcmlhdGlvbltdO1xuICBkYXRhOiBhbnkgPSB7fTtcblxuICBjb25zdHJ1Y3RvcihkYXRhOiBhbnkpIHtcbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgIHRoaXMudmFyaWF0aW9ucyA9IChkYXRhLnZhcmlhdGlvbnMgfHwgW10pLm1hcCgodjogYW55KSA9PiB7XG4gICAgICBuZXcgVmFyaWF0aW9uKHYpO1xuICAgIH0pO1xuICB9XG5cbiAgaWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhLmlkO1xuICB9XG5cbiAgZ29vZ2xlSWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhLnJlZjtcbiAgfVxuXG4gIG5hbWUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhLmxhYmVsO1xuICB9XG59XG5leHBvcnQgY2xhc3MgRXhwZXJpbWVudHMge1xuICBkcmFmdHM6IElFeHBlcmltZW50W107XG4gIHJ1bm5pbmc6IElFeHBlcmltZW50W107XG5cbiAgY29uc3RydWN0b3IoZGF0YTogYW55KSB7XG4gICAgaWYoZGF0YSkge1xuICAgICAgdGhpcy5kcmFmdHMgPSAoZGF0YS5kcmFmdHMgfHwgW10pLm1hcCgoZXhwOiBhbnkpID0+IHtcbiAgICAgICAgbmV3IEV4cGVyaW1lbnQoZXhwKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5ydW5uaW5nID0gKGRhdGEucnVubmluZyB8fCBbXSkubWFwKChleHA6IGFueSkgPT4ge1xuICAgICAgICBuZXcgRXhwZXJpbWVudChleHApO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgY3VycmVudCgpOiBJRXhwZXJpbWVudCB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLnJ1bm5pbmcubGVuZ3RoID4gMCA/IHRoaXMucnVubmluZ1swXSA6IG51bGw7XG4gIH1cbiAgcmVmRnJvbUNvb2tpZShjb29raWU6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xuICAgIGlmICghY29va2llIHx8IGNvb2tpZS50cmltKCkgPT09IFwiXCIpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IHNwbGl0dGVkID0gY29va2llLnRyaW0oKS5zcGxpdChcIiBcIik7XG4gICAgaWYgKHNwbGl0dGVkLmxlbmd0aCA8IDIpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IGV4cElkID0gc3BsaXR0ZWRbMF07XG4gICAgY29uc3QgdmFySW5kZXggPSBwYXJzZUludChzcGxpdHRlZFsxXSwgMTApO1xuICAgIGNvbnN0IGV4cCA9IHRoaXMucnVubmluZy5maWx0ZXIoZnVuY3Rpb24oZXhwKSB7XG4gICAgICByZXR1cm4gZXhwLmdvb2dsZUlkKCkgPT0gZXhwSWQgJiYgZXhwLnZhcmlhdGlvbnMubGVuZ3RoID4gdmFySW5kZXg7XG4gICAgfSlbMF07XG4gICAgcmV0dXJuIGV4cCA/IGV4cC52YXJpYXRpb25zW3ZhckluZGV4XS5yZWYoKSA6IG51bGw7XG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9leHBlcmltZW50cy50cyJdLCJtYXBwaW5ncyI6Ijs7QUF5QkE7QUFHQTtBQUZBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFsQkE7QUFvQkE7QUFJQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUF0QkE7QUF1QkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQTdCQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }),
/* 1 */
/* unknown exports provided */
/* all exports used */
/*!***************************!*\
  !*** ./src/predicates.ts ***!
  \***************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nexports.__esModule = true;\nvar Operator;\n(function (Operator) {\n    Operator[Operator[\"at\"] = 0] = \"at\";\n    Operator[Operator[\"not\"] = 1] = \"not\";\n    Operator[Operator[\"missing\"] = 2] = \"missing\";\n    Operator[Operator[\"has\"] = 3] = \"has\";\n    Operator[Operator[\"any\"] = 4] = \"any\";\n    Operator[Operator[\"in\"] = 5] = \"in\";\n    Operator[Operator[\"fulltext\"] = 6] = \"fulltext\";\n    Operator[Operator[\"similar\"] = 7] = \"similar\";\n    Operator[Operator[\"number.gt\"] = 8] = \"number.gt\";\n    Operator[Operator[\"number.lt\"] = 9] = \"number.lt\";\n    Operator[Operator[\"number.inRange\"] = 10] = \"number.inRange\";\n    Operator[Operator[\"date.before\"] = 11] = \"date.before\";\n    Operator[Operator[\"date.after\"] = 12] = \"date.after\";\n    Operator[Operator[\"date.between\"] = 13] = \"date.between\";\n    Operator[Operator[\"date.day-of-month\"] = 14] = \"date.day-of-month\";\n    Operator[Operator[\"date.day-of-month-after\"] = 15] = \"date.day-of-month-after\";\n    Operator[Operator[\"date.day-of-month-before\"] = 16] = \"date.day-of-month-before\";\n    Operator[Operator[\"date.day-of-week\"] = 17] = \"date.day-of-week\";\n    Operator[Operator[\"date.day-of-week-after\"] = 18] = \"date.day-of-week-after\";\n    Operator[Operator[\"date.day-of-week-before\"] = 19] = \"date.day-of-week-before\";\n    Operator[Operator[\"date.month\"] = 20] = \"date.month\";\n    Operator[Operator[\"date.month-before\"] = 21] = \"date.month-before\";\n    Operator[Operator[\"date.month-after\"] = 22] = \"date.month-after\";\n    Operator[Operator[\"date.year\"] = 23] = \"date.year\";\n    Operator[Operator[\"date.hour\"] = 24] = \"date.hour\";\n    Operator[Operator[\"date.hour-before\"] = 25] = \"date.hour-before\";\n    Operator[Operator[\"date.hour-after\"] = 26] = \"date.hour-after\";\n    Operator[Operator[\"geopoint.near\"] = 27] = \"geopoint.near\";\n})(Operator || (Operator = {}));\nvar AtPredicate = (function () {\n    function AtPredicate(fragment, value) {\n        this.op = Operator.at;\n        this.fragment = fragment;\n        this.value = value;\n    }\n    AtPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \\\"\" + this.value + \"\\\")]\";\n    };\n    return AtPredicate;\n}());\nvar NotPredicate = (function () {\n    function NotPredicate(fragment, value) {\n        this.op = Operator.not;\n        this.fragment = fragment;\n        this.value = value;\n    }\n    NotPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \\\"\" + this.value + \"\\\")]\";\n    };\n    return NotPredicate;\n}());\nvar MissingPredicate = (function () {\n    function MissingPredicate(fragment) {\n        this.op = Operator.missing;\n        this.fragment = fragment;\n    }\n    MissingPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\")]\";\n    };\n    return MissingPredicate;\n}());\nvar HasPredicate = (function () {\n    function HasPredicate(fragment) {\n        this.op = Operator.has;\n        this.fragment = fragment;\n    }\n    HasPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\")]\";\n    };\n    return HasPredicate;\n}());\nvar AnyPredicate = (function () {\n    function AnyPredicate(fragment, values) {\n        this.op = Operator.any;\n        this.fragment = fragment;\n        this.values = values;\n    }\n    AnyPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", [\" + this.values.join(',') + \"])]\";\n    };\n    return AnyPredicate;\n}());\nvar InPredicate = (function () {\n    function InPredicate(fragment, values) {\n        this.op = Operator[\"in\"];\n        this.fragment = fragment;\n        this.values = values;\n    }\n    InPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", [\" + this.values.join(',') + \"])]\";\n    };\n    return InPredicate;\n}());\nvar FulltextPredicate = (function () {\n    function FulltextPredicate(fragment, value) {\n        this.op = Operator.fulltext;\n        this.fragment = fragment;\n        this.value = value;\n    }\n    FulltextPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \\\"\" + this.value + \"\\\")]\";\n    };\n    return FulltextPredicate;\n}());\nvar SimilarPredicate = (function () {\n    function SimilarPredicate(documentId, maxResults) {\n        this.op = Operator.similar;\n        this.documentId = documentId;\n        this.maxResults = maxResults;\n    }\n    SimilarPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.documentId + \"\\\", \" + this.maxResults + \")]\";\n    };\n    return SimilarPredicate;\n}());\nvar GtPredicate = (function () {\n    function GtPredicate(fragment, value) {\n        this.op = Operator[\"number.gt\"];\n        this.fragment = fragment;\n        this.value = value;\n    }\n    GtPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.value + \")]\";\n    };\n    return GtPredicate;\n}());\nvar LtPredicate = (function () {\n    function LtPredicate(fragment, value) {\n        this.op = Operator[\"number.lt\"];\n        this.fragment = fragment;\n        this.value = value;\n    }\n    LtPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.value + \")]\";\n    };\n    return LtPredicate;\n}());\nvar InRangePredicate = (function () {\n    function InRangePredicate(fragment, before, after) {\n        this.op = Operator[\"number.inRange\"];\n        this.fragment = fragment;\n        this.before = before;\n        this.after = after;\n    }\n    InRangePredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.before + \", \" + this.after + \")]\";\n    };\n    return InRangePredicate;\n}());\nvar DateBeforePredicate = (function () {\n    function DateBeforePredicate(fragment, before) {\n        this.op = Operator[\"date.before\"];\n        this.fragment = fragment;\n        this.before = before;\n    }\n    DateBeforePredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.before.getTime() + \")]\";\n    };\n    return DateBeforePredicate;\n}());\nvar DateAfterPredicate = (function () {\n    function DateAfterPredicate(fragment, after) {\n        this.op = Operator[\"date.after\"];\n        this.fragment = fragment;\n        this.after = after;\n    }\n    DateAfterPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.after.getTime() + \")]\";\n    };\n    return DateAfterPredicate;\n}());\nvar DateBetweenPredicate = (function () {\n    function DateBetweenPredicate(fragment, before, after) {\n        this.op = Operator[\"date.between\"];\n        this.fragment = fragment;\n        this.before = before;\n        this.after = after;\n    }\n    DateBetweenPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.before.getTime() + \", \" + this.after.getTime() + \")]\";\n    };\n    return DateBetweenPredicate;\n}());\nvar DayOfMonthPredicate = (function () {\n    function DayOfMonthPredicate(fragment, day) {\n        this.op = Operator[\"date.day-of-month\"];\n        this.fragment = fragment;\n        this.day = day;\n    }\n    DayOfMonthPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.day + \")]\";\n    };\n    return DayOfMonthPredicate;\n}());\nvar DayOfMonthAfterPredicate = (function () {\n    function DayOfMonthAfterPredicate(fragment, day) {\n        this.op = Operator[\"date.day-of-month-after\"];\n        this.fragment = fragment;\n        this.day = day;\n    }\n    DayOfMonthAfterPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.day + \")]\";\n    };\n    return DayOfMonthAfterPredicate;\n}());\nvar DayOfMonthBeforePredicate = (function () {\n    function DayOfMonthBeforePredicate(fragment, day) {\n        this.op = Operator[\"date.day-of-month-before\"];\n        this.fragment = fragment;\n        this.day = day;\n    }\n    DayOfMonthBeforePredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.day + \")]\";\n    };\n    return DayOfMonthBeforePredicate;\n}());\nvar DayOfWeekPredicate = (function () {\n    function DayOfWeekPredicate(fragment, day) {\n        this.op = Operator[\"date.day-of-week\"];\n        this.fragment = fragment;\n        this.day = day;\n    }\n    DayOfWeekPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.day + \")]\";\n    };\n    return DayOfWeekPredicate;\n}());\nvar DayOfWeekAfterPredicate = (function () {\n    function DayOfWeekAfterPredicate(fragment, day) {\n        this.op = Operator[\"date.day-of-week-after\"];\n        this.fragment = fragment;\n        this.day = day;\n    }\n    DayOfWeekAfterPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.day + \")]\";\n    };\n    return DayOfWeekAfterPredicate;\n}());\nvar DayOfWeekBeforePredicate = (function () {\n    function DayOfWeekBeforePredicate(fragment, day) {\n        this.op = Operator[\"date.day-of-week-before\"];\n        this.fragment = fragment;\n        this.day = day;\n    }\n    DayOfWeekBeforePredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.day + \")]\";\n    };\n    return DayOfWeekBeforePredicate;\n}());\nvar MonthPredicate = (function () {\n    function MonthPredicate(fragment, month) {\n        this.op = Operator[\"date.month\"];\n        this.fragment = fragment;\n        this.month = month;\n    }\n    MonthPredicate.prototype.toString = function () {\n        if (typeof this.month === 'number') {\n            return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.month + \")]\";\n        }\n        else {\n            return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \\\"\" + this.month + \"\\\")]\";\n        }\n    };\n    return MonthPredicate;\n}());\nvar MonthBeforePredicate = (function () {\n    function MonthBeforePredicate(fragment, month) {\n        this.op = Operator[\"date.month-before\"];\n        this.fragment = fragment;\n        this.month = month;\n    }\n    MonthBeforePredicate.prototype.toString = function () {\n        if (typeof this.month === 'number') {\n            return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.month + \")]\";\n        }\n        else {\n            return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \\\"\" + this.month + \"\\\")]\";\n        }\n    };\n    return MonthBeforePredicate;\n}());\nvar MonthAfterPredicate = (function () {\n    function MonthAfterPredicate(fragment, month) {\n        this.op = Operator[\"date.month-after\"];\n        this.fragment = fragment;\n        this.month = month;\n    }\n    MonthAfterPredicate.prototype.toString = function () {\n        if (typeof this.month === 'number') {\n            return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.month + \")]\";\n        }\n        else {\n            return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \\\"\" + this.month + \"\\\")]\";\n        }\n    };\n    return MonthAfterPredicate;\n}());\nvar YearPredicate = (function () {\n    function YearPredicate(fragment, year) {\n        this.op = Operator[\"date.year\"];\n        this.fragment = fragment;\n        this.year = year;\n    }\n    YearPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.year + \")]\";\n    };\n    return YearPredicate;\n}());\nvar HourPredicate = (function () {\n    function HourPredicate(fragment, hour) {\n        this.op = Operator[\"date.hour\"];\n        this.fragment = fragment;\n        this.hour = hour;\n    }\n    HourPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.hour + \")]\";\n    };\n    return HourPredicate;\n}());\nvar HourBeforePredicate = (function () {\n    function HourBeforePredicate(fragment, hour) {\n        this.op = Operator[\"date.hour-before\"];\n        this.fragment = fragment;\n        this.hour = hour;\n    }\n    HourBeforePredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.hour + \")]\";\n    };\n    return HourBeforePredicate;\n}());\nvar HourAfterPredicate = (function () {\n    function HourAfterPredicate(fragment, hour) {\n        this.op = Operator[\"date.hour-after\"];\n        this.fragment = fragment;\n        this.hour = hour;\n    }\n    HourAfterPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.hour + \")]\";\n    };\n    return HourAfterPredicate;\n}());\nvar NearPredicate = (function () {\n    function NearPredicate(fragment, latitude, longitude, radius) {\n        this.op = Operator[\"geopoint.near\"];\n        this.fragment = fragment;\n        this.latitude = latitude;\n        this.longitude = longitude;\n        this.radius = radius;\n    }\n    NearPredicate.prototype.toString = function () {\n        return \"[:d = \" + this.op.valueOf + \"(\\\"\" + this.fragment + \"\\\", \" + this.latitude + \", \" + this.longitude + \", \" + this.radius + \")]\";\n    };\n    return NearPredicate;\n}());\nexports.Predicates = {\n    at: AtPredicate,\n    not: NotPredicate,\n    missing: MissingPredicate,\n    has: HasPredicate,\n    any: AnyPredicate,\n    \"in\": InPredicate,\n    fulltext: FulltextPredicate,\n    similar: SimilarPredicate,\n    gt: GtPredicate,\n    lt: LtPredicate,\n    inRange: InRangePredicate,\n    before: DateBeforePredicate,\n    after: DateAfterPredicate,\n    between: DateBetweenPredicate,\n    dayOfMonth: DayOfMonthPredicate,\n    dayOfMonthAfter: DayOfMonthAfterPredicate,\n    dayOfMonthBefore: DayOfMonthBeforePredicate,\n    dayOfWeek: DayOfWeekPredicate,\n    dayOfWeekAfter: DayOfWeekAfterPredicate,\n    dayOfWeekBefore: DayOfWeekBeforePredicate,\n    month: MonthPredicate,\n    monthBefore: MonthBeforePredicate,\n    monthAfter: MonthAfterPredicate,\n    year: YearPredicate,\n    hour: HourPredicate,\n    hourBefore: HourBeforePredicate,\n    hourAfter: HourAfterPredicate,\n    near: NearPredicate\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9wcmVkaWNhdGVzLnRzPzU4ZmEiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGludGVyZmFjZSBJUHJlZGljYXRlIHtcbiAgb3A6IE9wZXJhdG9yO1xuICB0b1N0cmluZygpOiBzdHJpbmc7XG59XG5cbmVudW0gT3BlcmF0b3Ige1xuICBhdCxcbiAgbm90LFxuICBtaXNzaW5nLFxuICBoYXMsXG4gIGFueSxcbiAgaW4sXG4gIGZ1bGx0ZXh0LFxuICBzaW1pbGFyLFxuICBcIm51bWJlci5ndFwiLFxuICBcIm51bWJlci5sdFwiLFxuICBcIm51bWJlci5pblJhbmdlXCIsXG4gIFwiZGF0ZS5iZWZvcmVcIixcbiAgXCJkYXRlLmFmdGVyXCIsXG4gIFwiZGF0ZS5iZXR3ZWVuXCIsXG4gIFwiZGF0ZS5kYXktb2YtbW9udGhcIixcbiAgXCJkYXRlLmRheS1vZi1tb250aC1hZnRlclwiLFxuICBcImRhdGUuZGF5LW9mLW1vbnRoLWJlZm9yZVwiLFxuICBcImRhdGUuZGF5LW9mLXdlZWtcIixcbiAgXCJkYXRlLmRheS1vZi13ZWVrLWFmdGVyXCIsXG4gIFwiZGF0ZS5kYXktb2Ytd2Vlay1iZWZvcmVcIixcbiAgXCJkYXRlLm1vbnRoXCIsXG4gIFwiZGF0ZS5tb250aC1iZWZvcmVcIixcbiAgXCJkYXRlLm1vbnRoLWFmdGVyXCIsXG4gIFwiZGF0ZS55ZWFyXCIsXG4gIFwiZGF0ZS5ob3VyXCIsXG4gIFwiZGF0ZS5ob3VyLWJlZm9yZVwiLFxuICBcImRhdGUuaG91ci1hZnRlclwiLFxuICBcImdlb3BvaW50Lm5lYXJcIlxufVxuXG5jbGFzcyBBdFByZWRpY2F0ZSBpbXBsZW1lbnRzIElQcmVkaWNhdGUge1xuICBmcmFnbWVudDogc3RyaW5nO1xuICB2YWx1ZTogc3RyaW5nO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvci5hdDtcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5mcmFnbWVudCA9IGZyYWdtZW50O1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIsIFwiJHt0aGlzLnZhbHVlfVwiKV1gO1xuICB9XG59XG5cbmNsYXNzIE5vdFByZWRpY2F0ZSBpbXBsZW1lbnRzIElQcmVkaWNhdGUge1xuICBmcmFnbWVudDogc3RyaW5nO1xuICB2YWx1ZTogc3RyaW5nO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvci5ub3Q7XG5cbiAgY29uc3RydWN0b3IoZnJhZ21lbnQ6IHN0cmluZywgdmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgWzpkID0gJHt0aGlzLm9wLnZhbHVlT2Z9KFwiJHt0aGlzLmZyYWdtZW50fVwiLCBcIiR7dGhpcy52YWx1ZX1cIildYDtcbiAgfVxufVxuXG5jbGFzcyBNaXNzaW5nUHJlZGljYXRlIGltcGxlbWVudHMgSVByZWRpY2F0ZSB7XG4gIGZyYWdtZW50OiBzdHJpbmc7XG4gIG9wOiBPcGVyYXRvciA9IE9wZXJhdG9yLm1pc3Npbmc7XG5cbiAgY29uc3RydWN0b3IoZnJhZ21lbnQ6IHN0cmluZykge1xuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIpXWA7XG4gIH1cbn1cblxuY2xhc3MgSGFzUHJlZGljYXRlIGltcGxlbWVudHMgSVByZWRpY2F0ZSB7XG4gIGZyYWdtZW50OiBzdHJpbmc7XG4gIG9wOiBPcGVyYXRvciA9IE9wZXJhdG9yLmhhcztcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nKSB7XG4gICAgdGhpcy5mcmFnbWVudCA9IGZyYWdtZW50O1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFs6ZCA9ICR7dGhpcy5vcC52YWx1ZU9mfShcIiR7dGhpcy5mcmFnbWVudH1cIildYDtcbiAgfVxufVxuXG5jbGFzcyBBbnlQcmVkaWNhdGUgaW1wbGVtZW50cyBJUHJlZGljYXRlIHtcbiAgZnJhZ21lbnQ6IHN0cmluZztcbiAgdmFsdWVzOiBzdHJpbmdbXTtcbiAgb3A6IE9wZXJhdG9yID0gT3BlcmF0b3IuYW55O1xuXG4gIGNvbnN0cnVjdG9yKGZyYWdtZW50OiBzdHJpbmcsIHZhbHVlczogc3RyaW5nW10pIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXM7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgWzpkID0gJHt0aGlzLm9wLnZhbHVlT2Z9KFwiJHt0aGlzLmZyYWdtZW50fVwiLCBbJHt0aGlzLnZhbHVlcy5qb2luKCcsJyl9XSldYDtcbiAgfVxufVxuXG5jbGFzcyBJblByZWRpY2F0ZSBpbXBsZW1lbnRzIElQcmVkaWNhdGUge1xuICBmcmFnbWVudDogc3RyaW5nO1xuICB2YWx1ZXM6IHN0cmluZ1tdO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvci5pbjtcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nLCB2YWx1ZXM6IHN0cmluZ1tdKSB7XG4gICAgdGhpcy5mcmFnbWVudCA9IGZyYWdtZW50O1xuICAgIHRoaXMudmFsdWVzID0gdmFsdWVzO1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFs6ZCA9ICR7dGhpcy5vcC52YWx1ZU9mfShcIiR7dGhpcy5mcmFnbWVudH1cIiwgWyR7dGhpcy52YWx1ZXMuam9pbignLCcpfV0pXWA7XG4gIH1cbn1cblxuY2xhc3MgRnVsbHRleHRQcmVkaWNhdGUgaW1wbGVtZW50cyBJUHJlZGljYXRlIHtcbiAgZnJhZ21lbnQ6IHN0cmluZztcbiAgdmFsdWU6IHN0cmluZztcbiAgb3A6IE9wZXJhdG9yID0gT3BlcmF0b3IuZnVsbHRleHQ7XG5cbiAgY29uc3RydWN0b3IoZnJhZ21lbnQ6IHN0cmluZywgdmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgWzpkID0gJHt0aGlzLm9wLnZhbHVlT2Z9KFwiJHt0aGlzLmZyYWdtZW50fVwiLCBcIiR7dGhpcy52YWx1ZX1cIildYDtcbiAgfVxufVxuXG5jbGFzcyBTaW1pbGFyUHJlZGljYXRlIGltcGxlbWVudHMgSVByZWRpY2F0ZSB7XG4gIGRvY3VtZW50SWQ6IHN0cmluZztcbiAgbWF4UmVzdWx0czogbnVtYmVyO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvci5zaW1pbGFyO1xuXG4gIGNvbnN0cnVjdG9yKGRvY3VtZW50SWQ6IHN0cmluZywgbWF4UmVzdWx0czogbnVtYmVyKSB7XG4gICAgdGhpcy5kb2N1bWVudElkID0gZG9jdW1lbnRJZDtcbiAgICB0aGlzLm1heFJlc3VsdHMgPSBtYXhSZXN1bHRzO1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFs6ZCA9ICR7dGhpcy5vcC52YWx1ZU9mfShcIiR7dGhpcy5kb2N1bWVudElkfVwiLCAke3RoaXMubWF4UmVzdWx0c30pXWA7XG4gIH1cbn1cblxuY2xhc3MgR3RQcmVkaWNhdGUgaW1wbGVtZW50cyBJUHJlZGljYXRlIHtcbiAgZnJhZ21lbnQ6IHN0cmluZztcbiAgdmFsdWU6IG51bWJlcjtcbiAgb3A6IE9wZXJhdG9yID0gT3BlcmF0b3JbXCJudW1iZXIuZ3RcIl07XG5cbiAgY29uc3RydWN0b3IoZnJhZ21lbnQ6IHN0cmluZywgdmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgWzpkID0gJHt0aGlzLm9wLnZhbHVlT2Z9KFwiJHt0aGlzLmZyYWdtZW50fVwiLCAke3RoaXMudmFsdWV9KV1gO1xuICB9XG59XG5cbmNsYXNzIEx0UHJlZGljYXRlIGltcGxlbWVudHMgSVByZWRpY2F0ZSB7XG4gIGZyYWdtZW50OiBzdHJpbmc7XG4gIHZhbHVlOiBudW1iZXI7XG4gIG9wOiBPcGVyYXRvciA9IE9wZXJhdG9yW1wibnVtYmVyLmx0XCJdO1xuXG4gIGNvbnN0cnVjdG9yKGZyYWdtZW50OiBzdHJpbmcsIHZhbHVlOiBudW1iZXIpIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFs6ZCA9ICR7dGhpcy5vcC52YWx1ZU9mfShcIiR7dGhpcy5mcmFnbWVudH1cIiwgJHt0aGlzLnZhbHVlfSldYDtcbiAgfVxufVxuXG5jbGFzcyBJblJhbmdlUHJlZGljYXRlIGltcGxlbWVudHMgSVByZWRpY2F0ZSB7XG4gIGZyYWdtZW50OiBzdHJpbmc7XG4gIGJlZm9yZTogbnVtYmVyO1xuICBhZnRlcjogbnVtYmVyO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvcltcIm51bWJlci5pblJhbmdlXCJdO1xuXG4gIGNvbnN0cnVjdG9yKGZyYWdtZW50OiBzdHJpbmcsIGJlZm9yZTogbnVtYmVyLCBhZnRlcjogbnVtYmVyKSB7XG4gICAgdGhpcy5mcmFnbWVudCA9IGZyYWdtZW50O1xuICAgIHRoaXMuYmVmb3JlID0gYmVmb3JlO1xuICAgIHRoaXMuYWZ0ZXIgPSBhZnRlcjtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIsICR7dGhpcy5iZWZvcmV9LCAke3RoaXMuYWZ0ZXJ9KV1gO1xuICB9XG59XG5cbmNsYXNzIERhdGVCZWZvcmVQcmVkaWNhdGUgaW1wbGVtZW50cyBJUHJlZGljYXRlIHtcbiAgZnJhZ21lbnQ6IHN0cmluZztcbiAgYmVmb3JlOiBEYXRlO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvcltcImRhdGUuYmVmb3JlXCJdO1xuXG4gIGNvbnN0cnVjdG9yKGZyYWdtZW50OiBzdHJpbmcsIGJlZm9yZTogRGF0ZSkge1xuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICB0aGlzLmJlZm9yZSA9IGJlZm9yZTtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIsICR7dGhpcy5iZWZvcmUuZ2V0VGltZSgpfSldYDtcbiAgfVxufVxuXG5jbGFzcyBEYXRlQWZ0ZXJQcmVkaWNhdGUgaW1wbGVtZW50cyBJUHJlZGljYXRlIHtcbiAgZnJhZ21lbnQ6IHN0cmluZztcbiAgYWZ0ZXI6IERhdGU7XG4gIG9wOiBPcGVyYXRvciA9IE9wZXJhdG9yW1wiZGF0ZS5hZnRlclwiXTtcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nLCBhZnRlcjogRGF0ZSkge1xuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICB0aGlzLmFmdGVyID0gYWZ0ZXI7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgWzpkID0gJHt0aGlzLm9wLnZhbHVlT2Z9KFwiJHt0aGlzLmZyYWdtZW50fVwiLCAke3RoaXMuYWZ0ZXIuZ2V0VGltZSgpfSldYDtcbiAgfVxufVxuXG5jbGFzcyBEYXRlQmV0d2VlblByZWRpY2F0ZSBpbXBsZW1lbnRzIElQcmVkaWNhdGUge1xuICBmcmFnbWVudDogc3RyaW5nO1xuICBiZWZvcmU6IERhdGU7XG4gIGFmdGVyOiBEYXRlO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvcltcImRhdGUuYmV0d2VlblwiXTtcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nLCBiZWZvcmU6IERhdGUsIGFmdGVyOiBEYXRlKSB7XG4gICAgdGhpcy5mcmFnbWVudCA9IGZyYWdtZW50O1xuICAgIHRoaXMuYmVmb3JlID0gYmVmb3JlO1xuICAgIHRoaXMuYWZ0ZXIgPSBhZnRlcjtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIsICR7dGhpcy5iZWZvcmUuZ2V0VGltZSgpfSwgJHt0aGlzLmFmdGVyLmdldFRpbWUoKX0pXWA7XG4gIH1cbn1cblxuY2xhc3MgRGF5T2ZNb250aFByZWRpY2F0ZSBpbXBsZW1lbnRzIElQcmVkaWNhdGUge1xuICBmcmFnbWVudDogc3RyaW5nO1xuICBkYXk6IG51bWJlcjtcbiAgb3A6IE9wZXJhdG9yID0gT3BlcmF0b3JbXCJkYXRlLmRheS1vZi1tb250aFwiXTtcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nLCBkYXk6IG51bWJlcikge1xuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICB0aGlzLmRheSA9IGRheTtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIsICR7dGhpcy5kYXl9KV1gO1xuICB9XG59XG5cbmNsYXNzIERheU9mTW9udGhBZnRlclByZWRpY2F0ZSBpbXBsZW1lbnRzIElQcmVkaWNhdGUge1xuICBmcmFnbWVudDogc3RyaW5nO1xuICBkYXk6IG51bWJlcjtcbiAgb3A6IE9wZXJhdG9yID0gT3BlcmF0b3JbXCJkYXRlLmRheS1vZi1tb250aC1hZnRlclwiXTtcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nLCBkYXk6IG51bWJlcikge1xuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICB0aGlzLmRheSA9IGRheTtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIsICR7dGhpcy5kYXl9KV1gO1xuICB9XG59XG5cbmNsYXNzIERheU9mTW9udGhCZWZvcmVQcmVkaWNhdGUgaW1wbGVtZW50cyBJUHJlZGljYXRlIHtcbiAgZnJhZ21lbnQ6IHN0cmluZztcbiAgZGF5OiBudW1iZXI7XG4gIG9wOiBPcGVyYXRvciA9IE9wZXJhdG9yW1wiZGF0ZS5kYXktb2YtbW9udGgtYmVmb3JlXCJdO1xuXG4gIGNvbnN0cnVjdG9yKGZyYWdtZW50OiBzdHJpbmcsIGRheTogbnVtYmVyKSB7XG4gICAgdGhpcy5mcmFnbWVudCA9IGZyYWdtZW50O1xuICAgIHRoaXMuZGF5ID0gZGF5O1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFs6ZCA9ICR7dGhpcy5vcC52YWx1ZU9mfShcIiR7dGhpcy5mcmFnbWVudH1cIiwgJHt0aGlzLmRheX0pXWA7XG4gIH1cbn1cblxuY2xhc3MgRGF5T2ZXZWVrUHJlZGljYXRlIGltcGxlbWVudHMgSVByZWRpY2F0ZSB7XG4gIGZyYWdtZW50OiBzdHJpbmc7XG4gIGRheTogbnVtYmVyO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvcltcImRhdGUuZGF5LW9mLXdlZWtcIl07XG5cbiAgY29uc3RydWN0b3IoZnJhZ21lbnQ6IHN0cmluZywgZGF5OiBudW1iZXIpIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgdGhpcy5kYXkgPSBkYXk7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgWzpkID0gJHt0aGlzLm9wLnZhbHVlT2Z9KFwiJHt0aGlzLmZyYWdtZW50fVwiLCAke3RoaXMuZGF5fSldYDtcbiAgfVxufVxuXG5jbGFzcyBEYXlPZldlZWtBZnRlclByZWRpY2F0ZSBpbXBsZW1lbnRzIElQcmVkaWNhdGUge1xuICBmcmFnbWVudDogc3RyaW5nO1xuICBkYXk6IG51bWJlcjtcbiAgb3A6IE9wZXJhdG9yID0gT3BlcmF0b3JbXCJkYXRlLmRheS1vZi13ZWVrLWFmdGVyXCJdO1xuXG4gIGNvbnN0cnVjdG9yKGZyYWdtZW50OiBzdHJpbmcsIGRheTogbnVtYmVyKSB7XG4gICAgdGhpcy5mcmFnbWVudCA9IGZyYWdtZW50O1xuICAgIHRoaXMuZGF5ID0gZGF5O1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFs6ZCA9ICR7dGhpcy5vcC52YWx1ZU9mfShcIiR7dGhpcy5mcmFnbWVudH1cIiwgJHt0aGlzLmRheX0pXWA7XG4gIH1cbn1cblxuY2xhc3MgRGF5T2ZXZWVrQmVmb3JlUHJlZGljYXRlIGltcGxlbWVudHMgSVByZWRpY2F0ZSB7XG4gIGZyYWdtZW50OiBzdHJpbmc7XG4gIGRheTogbnVtYmVyO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvcltcImRhdGUuZGF5LW9mLXdlZWstYmVmb3JlXCJdO1xuXG4gIGNvbnN0cnVjdG9yKGZyYWdtZW50OiBzdHJpbmcsIGRheTogbnVtYmVyKSB7XG4gICAgdGhpcy5mcmFnbWVudCA9IGZyYWdtZW50O1xuICAgIHRoaXMuZGF5ID0gZGF5O1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFs6ZCA9ICR7dGhpcy5vcC52YWx1ZU9mfShcIiR7dGhpcy5mcmFnbWVudH1cIiwgJHt0aGlzLmRheX0pXWA7XG4gIH1cbn1cbiBcbmNsYXNzIE1vbnRoUHJlZGljYXRlIGltcGxlbWVudHMgSVByZWRpY2F0ZSB7XG4gIGZyYWdtZW50OiBzdHJpbmc7XG4gIG1vbnRoOiBudW1iZXIgfCBzdHJpbmc7XG4gIG9wOiBPcGVyYXRvciA9IE9wZXJhdG9yW1wiZGF0ZS5tb250aFwiXTtcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nLCBtb250aDogbnVtYmVyIHwgc3RyaW5nKSB7XG4gICAgdGhpcy5mcmFnbWVudCA9IGZyYWdtZW50O1xuICAgIHRoaXMubW9udGggPSBtb250aDtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgaWYodHlwZW9mIHRoaXMubW9udGggPT09ICdudW1iZXInKSB7XG4gICAgICByZXR1cm4gYFs6ZCA9ICR7dGhpcy5vcC52YWx1ZU9mfShcIiR7dGhpcy5mcmFnbWVudH1cIiwgJHt0aGlzLm1vbnRofSldYDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIsIFwiJHt0aGlzLm1vbnRofVwiKV1gO1xuICAgIH1cbiAgfVxufVxuXG5jbGFzcyBNb250aEJlZm9yZVByZWRpY2F0ZSBpbXBsZW1lbnRzIElQcmVkaWNhdGUge1xuICBmcmFnbWVudDogc3RyaW5nO1xuICBtb250aDogbnVtYmVyIHwgc3RyaW5nO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvcltcImRhdGUubW9udGgtYmVmb3JlXCJdO1xuXG4gIGNvbnN0cnVjdG9yKGZyYWdtZW50OiBzdHJpbmcsIG1vbnRoOiBudW1iZXIgfCBzdHJpbmcpIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgdGhpcy5tb250aCA9IG1vbnRoO1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICBpZih0eXBlb2YgdGhpcy5tb250aCA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiBgWzpkID0gJHt0aGlzLm9wLnZhbHVlT2Z9KFwiJHt0aGlzLmZyYWdtZW50fVwiLCAke3RoaXMubW9udGh9KV1gO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYFs6ZCA9ICR7dGhpcy5vcC52YWx1ZU9mfShcIiR7dGhpcy5mcmFnbWVudH1cIiwgXCIke3RoaXMubW9udGh9XCIpXWA7XG4gICAgfVxuICB9XG59XG5cbmNsYXNzIE1vbnRoQWZ0ZXJQcmVkaWNhdGUgaW1wbGVtZW50cyBJUHJlZGljYXRlIHtcbiAgZnJhZ21lbnQ6IHN0cmluZztcbiAgbW9udGg6IG51bWJlciB8IHN0cmluZztcbiAgb3A6IE9wZXJhdG9yID0gT3BlcmF0b3JbXCJkYXRlLm1vbnRoLWFmdGVyXCJdO1xuXG4gIGNvbnN0cnVjdG9yKGZyYWdtZW50OiBzdHJpbmcsIG1vbnRoOiBudW1iZXIgfCBzdHJpbmcpIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgdGhpcy5tb250aCA9IG1vbnRoO1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICBpZih0eXBlb2YgdGhpcy5tb250aCA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiBgWzpkID0gJHt0aGlzLm9wLnZhbHVlT2Z9KFwiJHt0aGlzLmZyYWdtZW50fVwiLCAke3RoaXMubW9udGh9KV1gO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYFs6ZCA9ICR7dGhpcy5vcC52YWx1ZU9mfShcIiR7dGhpcy5mcmFnbWVudH1cIiwgXCIke3RoaXMubW9udGh9XCIpXWA7XG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFllYXJQcmVkaWNhdGUgaW1wbGVtZW50cyBJUHJlZGljYXRlIHtcbiAgZnJhZ21lbnQ6IHN0cmluZztcbiAgeWVhcjogbnVtYmVyO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvcltcImRhdGUueWVhclwiXTtcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nLCB5ZWFyOiBudW1iZXIpIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgdGhpcy55ZWFyID0geWVhcjtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIsICR7dGhpcy55ZWFyfSldYDtcbiAgfVxufVxuXG5jbGFzcyBIb3VyUHJlZGljYXRlIGltcGxlbWVudHMgSVByZWRpY2F0ZSB7XG4gIGZyYWdtZW50OiBzdHJpbmc7XG4gIGhvdXI6IG51bWJlcjtcbiAgb3A6IE9wZXJhdG9yID0gT3BlcmF0b3JbXCJkYXRlLmhvdXJcIl07XG5cbiAgY29uc3RydWN0b3IoZnJhZ21lbnQ6IHN0cmluZywgaG91cjogbnVtYmVyKSB7XG4gICAgdGhpcy5mcmFnbWVudCA9IGZyYWdtZW50O1xuICAgIHRoaXMuaG91ciA9IGhvdXI7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgWzpkID0gJHt0aGlzLm9wLnZhbHVlT2Z9KFwiJHt0aGlzLmZyYWdtZW50fVwiLCAke3RoaXMuaG91cn0pXWA7XG4gIH1cbn1cblxuY2xhc3MgSG91ckJlZm9yZVByZWRpY2F0ZSBpbXBsZW1lbnRzIElQcmVkaWNhdGUge1xuICBmcmFnbWVudDogc3RyaW5nO1xuICBob3VyOiBudW1iZXI7XG4gIG9wOiBPcGVyYXRvciA9IE9wZXJhdG9yW1wiZGF0ZS5ob3VyLWJlZm9yZVwiXTtcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nLCBob3VyOiBudW1iZXIpIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgdGhpcy5ob3VyID0gaG91cjtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIsICR7dGhpcy5ob3VyfSldYDtcbiAgfVxufVxuXG5jbGFzcyBIb3VyQWZ0ZXJQcmVkaWNhdGUgaW1wbGVtZW50cyBJUHJlZGljYXRlIHtcbiAgZnJhZ21lbnQ6IHN0cmluZztcbiAgaG91cjogbnVtYmVyO1xuICBvcDogT3BlcmF0b3IgPSBPcGVyYXRvcltcImRhdGUuaG91ci1hZnRlclwiXTtcblxuICBjb25zdHJ1Y3RvcihmcmFnbWVudDogc3RyaW5nLCBob3VyOiBudW1iZXIpIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgdGhpcy5ob3VyID0gaG91cjtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBbOmQgPSAke3RoaXMub3AudmFsdWVPZn0oXCIke3RoaXMuZnJhZ21lbnR9XCIsICR7dGhpcy5ob3VyfSldYDtcbiAgfVxufVxuXG5jbGFzcyBOZWFyUHJlZGljYXRlIGltcGxlbWVudHMgSVByZWRpY2F0ZSB7XG4gIGZyYWdtZW50OiBzdHJpbmc7XG4gIGxhdGl0dWRlOiBudW1iZXI7XG4gIGxvbmdpdHVkZTogbnVtYmVyO1xuICByYWRpdXM6IG51bWJlcjtcbiAgb3A6IE9wZXJhdG9yID0gT3BlcmF0b3JbXCJnZW9wb2ludC5uZWFyXCJdO1xuXG4gIGNvbnN0cnVjdG9yKGZyYWdtZW50OiBzdHJpbmcsIGxhdGl0dWRlOiBudW1iZXIsIGxvbmdpdHVkZTogbnVtYmVyLCByYWRpdXM6IG51bWJlcikge1xuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICB0aGlzLmxhdGl0dWRlID0gbGF0aXR1ZGU7XG4gICAgdGhpcy5sb25naXR1ZGUgPSBsb25naXR1ZGU7XG4gICAgdGhpcy5yYWRpdXMgPSByYWRpdXM7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgWzpkID0gJHt0aGlzLm9wLnZhbHVlT2Z9KFwiJHt0aGlzLmZyYWdtZW50fVwiLCAke3RoaXMubGF0aXR1ZGV9LCAke3RoaXMubG9uZ2l0dWRlfSwgJHt0aGlzLnJhZGl1c30pXWA7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IFByZWRpY2F0ZXMgPSB7XG4gIGF0OiBBdFByZWRpY2F0ZSxcbiAgbm90OiBOb3RQcmVkaWNhdGUsXG4gIG1pc3Npbmc6IE1pc3NpbmdQcmVkaWNhdGUsXG4gIGhhczogSGFzUHJlZGljYXRlLFxuICBhbnk6IEFueVByZWRpY2F0ZSxcbiAgaW46IEluUHJlZGljYXRlLFxuICBmdWxsdGV4dDogRnVsbHRleHRQcmVkaWNhdGUsXG4gIHNpbWlsYXI6IFNpbWlsYXJQcmVkaWNhdGUsXG4gIGd0OiBHdFByZWRpY2F0ZSxcbiAgbHQ6IEx0UHJlZGljYXRlLFxuICBpblJhbmdlOiBJblJhbmdlUHJlZGljYXRlLFxuICBiZWZvcmU6IERhdGVCZWZvcmVQcmVkaWNhdGUsXG4gIGFmdGVyOiBEYXRlQWZ0ZXJQcmVkaWNhdGUsXG4gIGJldHdlZW46IERhdGVCZXR3ZWVuUHJlZGljYXRlLFxuICBkYXlPZk1vbnRoOiBEYXlPZk1vbnRoUHJlZGljYXRlLFxuICBkYXlPZk1vbnRoQWZ0ZXI6IERheU9mTW9udGhBZnRlclByZWRpY2F0ZSxcbiAgZGF5T2ZNb250aEJlZm9yZTpEYXlPZk1vbnRoQmVmb3JlUHJlZGljYXRlLFxuICBkYXlPZldlZWs6IERheU9mV2Vla1ByZWRpY2F0ZSxcbiAgZGF5T2ZXZWVrQWZ0ZXI6IERheU9mV2Vla0FmdGVyUHJlZGljYXRlLFxuICBkYXlPZldlZWtCZWZvcmU6IERheU9mV2Vla0JlZm9yZVByZWRpY2F0ZSxcbiAgbW9udGg6IE1vbnRoUHJlZGljYXRlLFxuICBtb250aEJlZm9yZTogTW9udGhCZWZvcmVQcmVkaWNhdGUsXG4gIG1vbnRoQWZ0ZXI6IE1vbnRoQWZ0ZXJQcmVkaWNhdGUsXG4gIHllYXI6IFllYXJQcmVkaWNhdGUsXG4gIGhvdXI6IEhvdXJQcmVkaWNhdGUsXG4gIGhvdXJCZWZvcmU6IEhvdXJCZWZvcmVQcmVkaWNhdGUsXG4gIGhvdXJBZnRlcjogSG91ckFmdGVyUHJlZGljYXRlLFxuICBuZWFyOiBOZWFyUHJlZGljYXRlXG59O1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9wcmVkaWNhdGVzLnRzIl0sIm1hcHBpbmdzIjoiOztBQUtBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFLQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBS0E7QUFGQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUlBO0FBRkE7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBSUE7QUFGQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFLQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBS0E7QUFGQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUtBO0FBRkE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFLQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBS0E7QUFGQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUtBO0FBRkE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFNQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFLQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBS0E7QUFGQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQU1BO0FBRkE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUtBO0FBRkE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFLQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBS0E7QUFGQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUtBO0FBRkE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFLQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBS0E7QUFGQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUtBO0FBRkE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBS0E7QUFGQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFLQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUtBO0FBRkE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFLQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBS0E7QUFGQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUtBO0FBRkE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFPQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ }),
/* 2 */
/* unknown exports provided */
/* all exports used */
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nexports.__esModule = true;\nvar documents_1 = __webpack_require__(/*! ./documents */ 6);\nvar api_1 = __webpack_require__(/*! ./api */ 4);\nvar Predicates = __webpack_require__(/*! ./predicates */ 1);\nvar experiments_1 = __webpack_require__(/*! ./experiments */ 0);\nfunction getApi(url, options) {\n    var api = new api_1.Api(url, options);\n    //Use cached api data if available\n    return new Promise(function (resolve, reject) {\n        var cb = function (err, value, xhr) {\n            if (options.complete)\n                options.complete(err, value, xhr);\n            if (err) {\n                reject(err);\n            }\n            else {\n                resolve(value);\n            }\n        };\n        api.get(function (err, data) {\n            if (!err && data) {\n                api.data = data;\n                api.bookmarks = data.bookmarks;\n                api.experiments = new experiments_1.Experiments(data.experiments);\n            }\n            cb(err, api);\n        });\n        return api;\n    });\n}\nexports[\"default\"] = {\n    experimentCookie: api_1.ExperimentCookie,\n    previewCookie: api_1.PreviewCookie,\n    Document: documents_1.Document,\n    SearchForm: api_1.SearchForm,\n    Form: api_1.Form,\n    Experiments: experiments_1.Experiments,\n    Predicates: Predicates,\n    api: getApi\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9pbmRleC50cz9lYWMzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERvY3VtZW50LCBHcm91cERvYyB9IGZyb20gXCIuL2RvY3VtZW50c1wiO1xuaW1wb3J0IHtcbiAgSUFwaU9wdGlvbnMsXG4gIElBcGksXG4gIEFwaSxcbiAgRXhwZXJpbWVudENvb2tpZSxcbiAgUHJldmlld0Nvb2tpZSxcbiAgRm9ybSxcbiAgU2VhcmNoRm9ybVxufSBmcm9tIFwiLi9hcGlcIjtcblxuaW1wb3J0IHsgRGVmYXVsdFJlcXVlc3RIYW5kbGVyIH0gZnJvbSAnLi9yZXF1ZXN0JztcbmltcG9ydCAqIGFzIFByZWRpY2F0ZXMgZnJvbSAnLi9wcmVkaWNhdGVzJztcbmltcG9ydCB7IEV4cGVyaW1lbnRzIH0gZnJvbSAnLi9leHBlcmltZW50cyc7XG5cbmZ1bmN0aW9uIGdldEFwaSh1cmw6IHN0cmluZywgb3B0aW9uczogSUFwaU9wdGlvbnMpOiBQcm9taXNlPElBcGk+IHtcbiAgdmFyIGFwaSA9IG5ldyBBcGkodXJsLCBvcHRpb25zKTtcbiAgLy9Vc2UgY2FjaGVkIGFwaSBkYXRhIGlmIGF2YWlsYWJsZVxuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIGNiID0gZnVuY3Rpb24oZXJyOiBFcnJvciB8IG51bGwsIHZhbHVlPzogYW55LCB4aHI/OiBhbnkpIHtcbiAgICAgIGlmIChvcHRpb25zLmNvbXBsZXRlKSBvcHRpb25zLmNvbXBsZXRlKGVyciwgdmFsdWUsIHhocik7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBhcGkuZ2V0KGZ1bmN0aW9uIChlcnI6IEVycm9yLCBkYXRhOiBhbnkpIHtcbiAgICAgIGlmICghZXJyICYmIGRhdGEpIHtcbiAgICAgICAgYXBpLmRhdGEgPSBkYXRhO1xuICAgICAgICBhcGkuYm9va21hcmtzID0gZGF0YS5ib29rbWFya3M7XG4gICAgICAgIGFwaS5leHBlcmltZW50cyA9IG5ldyBFeHBlcmltZW50cyhkYXRhLmV4cGVyaW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgY2IoZXJyLCBhcGkpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGFwaTtcbiAgfSk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgZXhwZXJpbWVudENvb2tpZTogRXhwZXJpbWVudENvb2tpZSxcbiAgcHJldmlld0Nvb2tpZTogUHJldmlld0Nvb2tpZSxcbiAgRG9jdW1lbnQ6IERvY3VtZW50LFxuICBTZWFyY2hGb3JtOiBTZWFyY2hGb3JtLFxuICBGb3JtOiBGb3JtLFxuICBFeHBlcmltZW50czogRXhwZXJpbWVudHMsXG4gIFByZWRpY2F0ZXM6IFByZWRpY2F0ZXMsXG4gIGFwaTogZ2V0QXBpXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2luZGV4LnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFXQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }),
/* 3 */
/* unknown exports provided */
/* all exports used */
/*!****************************************************!*\
  !*** ./~/isomorphic-fetch/fetch-npm-browserify.js ***!
  \****************************************************/
/***/ (function(module, exports, __webpack_require__) {

eval("// the whatwg-fetch polyfill installs the fetch() function\n// on the global object (window or self)\n//\n// Return that as the export for use in Webpack, Browserify etc.\n__webpack_require__(/*! whatwg-fetch */ 9);\nmodule.exports = self.fetch.bind(self);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL34vaXNvbW9ycGhpYy1mZXRjaC9mZXRjaC1ucG0tYnJvd3NlcmlmeS5qcz83NzIzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHRoZSB3aGF0d2ctZmV0Y2ggcG9seWZpbGwgaW5zdGFsbHMgdGhlIGZldGNoKCkgZnVuY3Rpb25cbi8vIG9uIHRoZSBnbG9iYWwgb2JqZWN0ICh3aW5kb3cgb3Igc2VsZilcbi8vXG4vLyBSZXR1cm4gdGhhdCBhcyB0aGUgZXhwb3J0IGZvciB1c2UgaW4gV2VicGFjaywgQnJvd3NlcmlmeSBldGMuXG5yZXF1aXJlKCd3aGF0d2ctZmV0Y2gnKTtcbm1vZHVsZS5leHBvcnRzID0gc2VsZi5mZXRjaC5iaW5kKHNlbGYpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2lzb21vcnBoaWMtZmV0Y2gvZmV0Y2gtbnBtLWJyb3dzZXJpZnkuanNcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ }),
/* 4 */
/* unknown exports provided */
/* all exports used */
/*!********************!*\
  !*** ./src/api.ts ***!
  \********************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nexports.__esModule = true;\nvar predicates_1 = __webpack_require__(/*! ./predicates */ 1);\nvar experiments_1 = __webpack_require__(/*! ./experiments */ 0);\nvar request_1 = __webpack_require__(/*! ./request */ 8);\nvar cache_1 = __webpack_require__(/*! ./cache */ 5);\nexports.PreviewCookie = \"io.prismic.preview\";\nexports.ExperimentCookie = \"io.prismic.experiment\";\nvar Ref = (function () {\n    function Ref(ref, label, isMaster, scheduledAt, id) {\n        this.ref = ref;\n        this.label = label;\n        this.isMaster = isMaster;\n        this.scheduledAt = scheduledAt;\n        this.id = id;\n    }\n    return Ref;\n}());\nexports.Ref = Ref;\nvar Form = (function () {\n    function Form(fields, action, name, rel, form_method, enctype) {\n        this.fields = fields;\n        this.action = action;\n        this.name = name;\n        this.rel = rel;\n        this.form_method = form_method;\n        this.enctype = enctype;\n    }\n    Form.prototype.getField = function (field) {\n        return this.fields[field];\n    };\n    Form.prototype.getFieldSafe = function (field) {\n        var f = this.fields[field];\n        if (!f)\n            throw new Error(\"Missing field \" + f + \" in form fields \" + this.fields);\n        return f;\n    };\n    return Form;\n}());\nexports.Form = Form;\nvar SearchForm = (function () {\n    function SearchForm(api, form, data) {\n        this.api = api;\n        this.form = form;\n        this.data = data || {};\n        for (var field in form.fields) {\n            if (form.getFieldSafe(field)['default']) {\n                this.data[field] = [form.fields[field]['default']];\n            }\n        }\n    }\n    SearchForm.prototype.set = function (field, value) {\n        var _this = this;\n        var fieldDesc = this.form.getField(field);\n        if (!fieldDesc)\n            throw new Error(\"Unknown field \" + field);\n        var checkedValue = function () { return value === '' || value === undefined ? null : value; };\n        var values = (function () {\n            var defaultValues = _this.data[field] || [];\n            if (fieldDesc.multiple) {\n                return checkedValue ? defaultValues.concat([checkedValue]) : defaultValues;\n            }\n            else {\n                return checkedValue ? [checkedValue] : defaultValues;\n            }\n        })();\n        return this;\n    };\n    /**\n     * Sets a ref to query on for this SearchForm. This is a mandatory\n     * method to call before calling submit(), and api.form('everything').submit()\n     * will not work.\n     */\n    SearchForm.prototype.ref = function (ref) {\n        return this.set(\"ref\", ref);\n    };\n    /**\n     * Sets a predicate-based query for this SearchForm. This is where you\n     * paste what you compose in your prismic.io API browser.\n     */\n    SearchForm.prototype.query = function (query) {\n        if (typeof query === 'string') {\n            return this.set(\"q\", query);\n        }\n        else if (query instanceof Array) {\n            var predicates = query.map(function (predicate) {\n                return predicate.toString();\n            });\n            return this.query(\"[\" + predicates.join(\"\") + \"]\");\n        }\n        else {\n            return this.query([query]);\n        }\n    };\n    /**\n     * Sets a page size to query for this SearchForm. This is an optional method.\n     *\n     * @param {number} size - The page size\n     * @returns {SearchForm} - The SearchForm itself\n     */\n    SearchForm.prototype.pageSize = function (size) {\n        return this.set(\"pageSize\", size);\n    };\n    /**\n     * Restrict the results document to the specified fields\n     */\n    SearchForm.prototype.fetch = function (fields) {\n        var strFields = fields instanceof Array ? fields.join(\",\") : fields;\n        return this.set(\"fetch\", strFields);\n    };\n    /**\n     * Include the requested fields in the DocumentLink instances in the result\n     */\n    SearchForm.prototype.fetchLinks = function (fields) {\n        var strFields = fields instanceof Array ? fields.join(\",\") : fields;\n        return this.set(\"fetchLinks\", strFields);\n    };\n    /**\n     * Sets the language to query for this SearchForm. This is an optional method.\n     */\n    SearchForm.prototype.lang = function (langCode) {\n        return this.set(\"lang\", langCode);\n    };\n    /**\n     * Sets the page number to query for this SearchForm. This is an optional method.\n     */\n    SearchForm.prototype.page = function (p) {\n        return this.set(\"page\", p);\n    };\n    /**\n     * Sets the orderings to query for this SearchForm. This is an optional method.\n     */\n    SearchForm.prototype.orderings = function (orderings) {\n        if (!orderings) {\n            return this;\n        }\n        else {\n            return this.set(\"orderings\", \"[\" + orderings.join(\",\") + \"]\");\n        }\n    };\n    /**\n     * Submits the query, and calls the callback function.\n     */\n    SearchForm.prototype.submit = function (callback) {\n        var self = this;\n        var url = this.form.action;\n        if (this.data) {\n            var sep = (url.indexOf('?') > -1 ? '&' : '?');\n            for (var key in this.data) {\n                if (this.data.hasOwnProperty(key)) {\n                    var values = this.data[key];\n                    if (values) {\n                        for (var i = 0; i < values.length; i++) {\n                            url += sep + key + '=' + encodeURIComponent(values[i]);\n                            sep = '&';\n                        }\n                    }\n                }\n            }\n        }\n        return this.api.requestHandler.request(url, callback);\n    };\n    return SearchForm;\n}());\nexports.SearchForm = SearchForm;\nvar ApiResponse = (function () {\n    function ApiResponse(page, results_per_page, results_size, total_results_size, total_pages, next_page, prev_page, results) {\n        this.page = page;\n        this.results_per_page = results_per_page;\n        this.results_size = results_size;\n        this.total_results_size = total_results_size;\n        this.total_pages = total_pages;\n        this.next_page = next_page;\n        this.prev_page = prev_page;\n        this.results = results;\n    }\n    return ApiResponse;\n}());\nexports.ApiResponse = ApiResponse;\nvar Api = (function () {\n    function Api(url, options) {\n        var opts = options || {};\n        this.accessToken = opts.accessToken;\n        this.url = url + (this.accessToken ? (url.indexOf('?') > -1 ? '&' : '?') + 'access_token=' + this.accessToken : '');\n        this.apiCache = opts.apiCache || new cache_1.DefaultApiCache();\n        this.requestHandler = opts.requestHandler || new request_1.DefaultRequestHandler();\n        this.apiCacheKey = this.url + (this.accessToken ? ('#' + this.accessToken) : '');\n        this.apiDataTTL = opts.apiDataTTL || 5;\n        return this;\n    }\n    /**\n     * Fetches data used to construct the api client, from cache if it's\n     * present, otherwise from calling the prismic api endpoint (which is\n     * then cached).\n     */\n    Api.prototype.get = function (callback) {\n        var self = this;\n        var cacheKey = this.apiCacheKey;\n        return new Promise(function (resolve, reject) {\n            var cb = function (err, value, xhr, ttl) {\n                if (callback)\n                    callback(err, value, xhr, ttl);\n                if (value)\n                    resolve(value);\n                if (err)\n                    reject(err);\n            };\n            self.apiCache.get(cacheKey, function (err, value) {\n                if (err || value) {\n                    cb(err, value);\n                    return;\n                }\n                self.requestHandler.request(self.url, function (err, value, xhr, ttl) {\n                    if (err) {\n                        cb(err, null, xhr, ttl);\n                        return;\n                    }\n                    var parsed = self.parse(value);\n                    ttl = ttl || self.apiDataTTL;\n                    self.apiCache.set(cacheKey, parsed, ttl, function (err) {\n                        cb(err, parsed, xhr, ttl);\n                    });\n                });\n            });\n        });\n    };\n    /**\n     * Cleans api data from the cache and fetches an up to date copy.\n     *\n     * @param {function} callback - Optional callback function that is called after the data has been refreshed\n     * @returns {Promise}\n     */\n    Api.prototype.refresh = function (callback) {\n        var self = this;\n        var cacheKey = this.apiCacheKey;\n        return new Promise(function (resolve, reject) {\n            var cb = function (err, value, xhr) {\n                if (callback)\n                    callback(err, value, xhr);\n                if (value)\n                    resolve(value);\n                if (err)\n                    reject(err);\n            };\n            self.apiCache.remove(cacheKey, function (err) {\n                if (err) {\n                    cb(err);\n                    return;\n                }\n                self.get(function (err, data) {\n                    if (err) {\n                        cb(err);\n                        return;\n                    }\n                    self.data = data;\n                    self.bookmarks = data.bookmarks;\n                    self.experiments = new experiments_1.Experiments(data.experiments);\n                    cb();\n                });\n            });\n        });\n    };\n    /**\n     * Parses and returns the /api document.\n     * This is for internal use, from outside this kit, you should call Prismic.Api()\n     *\n     * @param {string} data - The JSON document responded on the API's endpoint\n     * @returns {Api} - The Api object that can be manipulated\n     * @private\n     */\n    Api.prototype.parse = function (data) {\n        var _this = this;\n        // Parse the forms\n        var forms = Object.keys(data.forms || []).reduce(function (acc, key, i) {\n            if (data.forms.hasOwnProperty(key)) {\n                var f = data.forms[key];\n                if (_this.accessToken) {\n                    f.fields['access_token'] = {};\n                    f.fields['access_token']['type'] = 'string';\n                    f.fields['access_token']['default'] = _this.accessToken;\n                }\n                var form = new Form(f.name, f.fields, f.form_method, f.rel, f.enctype, f.action);\n                acc[key] = form;\n            }\n            else {\n                return acc;\n            }\n        }, {});\n        var refs = data.refs.map(function (r) {\n            return new Ref(r.ref, r.label, r.isMasterRef, r.scheduledAt, r.id);\n        }) || [];\n        var master = refs.filter(function (r) {\n            return r.isMaster === true;\n        });\n        var types = data.types;\n        var tags = data.tags;\n        if (master.length === 0) {\n            throw (\"No master ref.\");\n        }\n        return {\n            bookmarks: data.bookmarks || {},\n            refs: refs,\n            forms: forms,\n            master: master[0],\n            types: types,\n            tags: tags,\n            experiments: data.experiments,\n            oauthInitiate: data['oauth_initiate'],\n            oauthToken: data['oauth_token'],\n            quickRoutes: data.quickRoutes\n        };\n    };\n    /**\n     * Returns a useable form from its id, as described in the RESTful description of the API.\n     * For instance: api.form(\"everything\") works on every repository (as \"everything\" exists by default)\n     * You can then chain the calls: api.form(\"everything\").query('[[:d = at(document.id, \"UkL0gMuvzYUANCpf\")]]').ref(ref).submit()\n     */\n    Api.prototype.form = function (formId) {\n        var form = this.data.forms[formId];\n        if (form) {\n            return new SearchForm(this, form, {});\n        }\n        return null;\n    };\n    Api.prototype.everything = function () {\n        var f = this.form(\"everything\");\n        if (!f)\n            throw new Error(\"Missing everything form\");\n        return f;\n    };\n    /**\n     * The ID of the master ref on this prismic.io API.\n     * Do not use like this: searchForm.ref(api.master()).\n     * Instead, set your ref once in a variable, and call it when you need it; this will allow to change the ref you're viewing easily for your entire page.\n     */\n    Api.prototype.master = function () {\n        return this.data.master.ref;\n    };\n    /**\n     * Returns the ref ID for a given ref's label.\n     * Do not use like this: searchForm.ref(api.ref(\"Future release label\")).\n     * Instead, set your ref once in a variable, and call it when you need it; this will allow to change the ref you're viewing easily for your entire page.\n     */\n    Api.prototype.ref = function (label) {\n        for (var i = 0; i < this.data.refs.length; i++) {\n            if (this.data.refs[i].label == label) {\n                return this.data.refs[i].ref;\n            }\n        }\n        return null;\n    };\n    /**\n     * The current experiment, or null\n     */\n    Api.prototype.currentExperiment = function () {\n        return this.experiments.current();\n    };\n    Api.prototype.quickRoutesEnabled = function () {\n        return this.data.quickRoutes.enabled;\n    };\n    /**\n     * Retrieve quick routes definitions\n     */\n    Api.prototype.quickRoutes = function (callback) {\n        var self = this;\n        return new Promise(function (resolve, reject) {\n            this.requestHandler.request(self.data.quickRoutes.url, function (err, data, xhr) {\n                if (callback)\n                    callback(err, data, xhr);\n                if (err)\n                    reject(err);\n                if (data)\n                    resolve(data);\n            });\n        });\n    };\n    /**\n     * Query the repository\n     * @param {string|array|Predicate} the query itself\n     * @param {object} additional parameters. In NodeJS, pass the request as 'req'.\n     * @param {function} callback(err, response)\n     */\n    Api.prototype.query = function (q, optionsOrCallback, cb) {\n        var _a = typeof optionsOrCallback === 'function'\n            ? { options: {}, callback: optionsOrCallback }\n            : { options: optionsOrCallback || {}, callback: cb }, options = _a.options, callback = _a.callback;\n        var opts = options;\n        var form = this.everything();\n        for (var key in opts) {\n            form = form.set(key, opts[key]);\n        }\n        if (q) {\n            form.query(q);\n        }\n        return form.submit(callback);\n    };\n    /**\n     * Retrieve the document returned by the given query\n     * @param {string|array|Predicate} the query\n     * @param {object} additional parameters. In NodeJS, pass the request as 'req'.\n     * @param {function} callback(err, doc)\n     */\n    Api.prototype.queryFirst = function (q, optionsOrCallback, cb) {\n        var _a = typeof optionsOrCallback === 'function'\n            ? { options: {}, callback: optionsOrCallback }\n            : { options: optionsOrCallback || {}, callback: cb }, options = _a.options, callback = _a.callback;\n        var opts = options;\n        opts.page = 1;\n        opts.pageSize = 1;\n        return this.query(q, opts, function (err, response) {\n            if (callback) {\n                var result = response && response.results && response.results[0];\n                callback(err, result);\n            }\n        }).then(function (response) {\n            return response && response.results && response.results[0];\n        });\n    };\n    /**\n     * Retrieve the document with the given id\n     */\n    Api.prototype.getByID = function (id, options, callback) {\n        options = options || {};\n        if (!options.lang)\n            options.lang = '*';\n        return this.queryFirst(new predicates_1.Predicates.at('document.id', id), options, callback);\n    };\n    /**\n     * Retrieve multiple documents from an array of id\n     */\n    Api.prototype.getByIDs = function (ids, options, callback) {\n        options = options || {};\n        if (!options.lang)\n            options.lang = '*';\n        return this.query(new predicates_1.Predicates[\"in\"]('document.id', ids), options, callback);\n    };\n    /**\n     * Retrieve the document with the given uid\n     */\n    Api.prototype.getByUID = function (type, uid, options, callback) {\n        options = options || {};\n        if (!options.lang)\n            options.lang = '*';\n        return this.queryFirst(new predicates_1.Predicates.at(\"my.\" + type + \".uid\", uid), options, callback);\n    };\n    /**\n     * Retrieve the singleton document with the given type\n     */\n    Api.prototype.getSingle = function (type, options, callback) {\n        return this.queryFirst(new predicates_1.Predicates.at('document.type', type), options, callback);\n    };\n    /**\n     * Retrieve the document with the given bookmark\n     */\n    Api.prototype.getBookmark = function (bookmark, options, callback) {\n        return new Promise(function (resolve, reject) {\n            var id = this.bookmarks[bookmark];\n            if (id) {\n                resolve(id);\n            }\n            else {\n                var err = new Error(\"Error retrieving bookmarked id\");\n                if (callback)\n                    callback(err);\n                reject(err);\n            }\n        }).then(function (id) {\n            return this.getByID(id, options, callback);\n        });\n    };\n    /**\n     * Return the URL to display a given preview\n     */\n    Api.prototype.previewSession = function (token, linkResolver, defaultUrl, callback) {\n        var api = this;\n        return new Promise(function (resolve, reject) {\n            var cb = function (err, url, xhr) {\n                if (callback)\n                    callback(err, url, xhr);\n                if (err) {\n                    reject(err);\n                }\n                else {\n                    resolve(url);\n                }\n            };\n            api.requestHandler.request(token, function (err, result, xhr) {\n                if (err) {\n                    cb(err, defaultUrl, xhr);\n                    return;\n                }\n                try {\n                    var mainDocumentId = result.mainDocument;\n                    if (!mainDocumentId) {\n                        cb(null, defaultUrl, xhr);\n                    }\n                    else {\n                        api.everything().query(new predicates_1.Predicates.at(\"document.id\", mainDocumentId)).ref(token).lang('*').submit(function (err, response) {\n                            if (err) {\n                                cb(err);\n                            }\n                            try {\n                                if (response.results.length === 0) {\n                                    cb(null, defaultUrl, xhr);\n                                }\n                                else {\n                                    cb(null, linkResolver(response.results[0]), xhr);\n                                }\n                            }\n                            catch (e) {\n                                cb(e);\n                            }\n                        });\n                    }\n                }\n                catch (e) {\n                    cb(e, defaultUrl, xhr);\n                }\n            });\n        });\n    };\n    /**\n     * Fetch a URL corresponding to a query, and parse the response as a Response object\n     */\n    Api.prototype.request = function (url, callback) {\n        var api = this;\n        var cacheKey = url + (this.accessToken ? ('#' + this.accessToken) : '');\n        var cache = this.apiCache;\n        function run(cb) {\n            cache.get(cacheKey, function (err, value) {\n                if (err || value) {\n                    cb(err, api.response(value));\n                    return;\n                }\n                api.requestHandler.request(url, function (err, documents, xhr, ttl) {\n                    if (err) {\n                        cb(err, null, xhr);\n                        return;\n                    }\n                    if (ttl) {\n                        cache.set(cacheKey, documents, ttl, function (err) {\n                            cb(err, api.response(documents));\n                        });\n                    }\n                    else {\n                        cb(null, api.response(documents));\n                    }\n                });\n            });\n        }\n        return new Promise(function (resolve, reject) {\n            run(function (err, value, xhr) {\n                if (callback)\n                    callback(err, value, xhr);\n                if (err)\n                    reject(err);\n                if (value)\n                    resolve(value);\n            });\n        });\n    };\n    Api.prototype.getNextPage = function (nextPage, callback) {\n        return this.request(nextPage + (this.accessToken ? '&access_token=' + this.accessToken : ''), callback);\n    };\n    /**\n     * JSON documents to Response object\n     */\n    Api.prototype.response = function (documents) {\n        return new ApiResponse(documents.page, documents.results_per_page, documents.results_size, documents.total_results_size, documents.total_pages, documents.next_page, documents.prev_page, documents.results || []);\n    };\n    return Api;\n}());\nexports.Api = Api;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9hcGkudHM/OTJlZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJUHJlZGljYXRlLCBQcmVkaWNhdGVzIH0gZnJvbSAnLi9wcmVkaWNhdGVzJztcbmltcG9ydCB7IElFeHBlcmltZW50cywgSUV4cGVyaW1lbnQsIEV4cGVyaW1lbnRzIH0gZnJvbSAnLi9leHBlcmltZW50cyc7XG5pbXBvcnQgeyBJUmVxdWVzdEhhbmRsZXIsIERlZmF1bHRSZXF1ZXN0SGFuZGxlciB9IGZyb20gJy4vcmVxdWVzdCc7XG5pbXBvcnQgeyBJRG9jdW1lbnQgfSBmcm9tICcuL2RvY3VtZW50cyc7XG5pbXBvcnQgeyBJQXBpQ2FjaGUsIERlZmF1bHRBcGlDYWNoZSB9IGZyb20gJy4vY2FjaGUnO1xuaW1wb3J0IENvb2tpZXMgZnJvbSAnLi9jb29raWVzJztcbmV4cG9ydCBjb25zdCBQcmV2aWV3Q29va2llID0gXCJpby5wcmlzbWljLnByZXZpZXdcIjtcbmV4cG9ydCBjb25zdCBFeHBlcmltZW50Q29va2llID0gXCJpby5wcmlzbWljLmV4cGVyaW1lbnRcIjtcblxuXG5pbnRlcmZhY2UgSVJlZiB7XG4gIHJlZjogc3RyaW5nO1xuICBsYWJlbDogc3RyaW5nO1xuICBpc01hc3Rlcjogc3RyaW5nO1xuICBzY2hlZHVsZWRBdDogc3RyaW5nO1xuICBpZDogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgUmVmIGltcGxlbWVudHMgSVJlZiB7XG4gIHJlZjogc3RyaW5nO1xuICBsYWJlbDogc3RyaW5nO1xuICBpc01hc3Rlcjogc3RyaW5nO1xuICBzY2hlZHVsZWRBdDogc3RyaW5nO1xuICBpZDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHJlZjogc3RyaW5nLCBsYWJlbDogc3RyaW5nLCBpc01hc3Rlcjogc3RyaW5nLCBzY2hlZHVsZWRBdDogc3RyaW5nLCBpZDogc3RyaW5nKSB7XG4gICAgdGhpcy5yZWYgPSByZWY7XG4gICAgdGhpcy5sYWJlbCA9IGxhYmVsO1xuICAgIHRoaXMuaXNNYXN0ZXIgPSBpc01hc3RlcjtcbiAgICB0aGlzLnNjaGVkdWxlZEF0ID0gc2NoZWR1bGVkQXQ7XG4gICAgdGhpcy5pZCA9IGlkO1xuICB9XG59XG5cblxuaW50ZXJmYWNlIElGaWVsZCB7XG4gIFtrZXk6IHN0cmluZ106IHN0cmluZztcbiAgdmFsdWU6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIElGb3JtIHtcbiAgZmllbGRzOiBhbnk7XG4gIGFjdGlvbjogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHJlbDogc3RyaW5nO1xuICBmb3JtX21ldGhvZDogc3RyaW5nO1xuICBlbmN0eXBlOiBzdHJpbmc7XG5cbiAgZ2V0RmllbGQoZmllbGQ6IHN0cmluZyk6IElGaWVsZCB8IHVuZGVmaW5lZFxuICBnZXRGaWVsZFNhZmUoZmllbGQ6IHN0cmluZyk6IElGaWVsZFxufVxuXG5leHBvcnQgY2xhc3MgRm9ybSBpbXBsZW1lbnRzIElGb3JtIHtcbiAgZmllbGRzOiBhbnk7XG4gIGFjdGlvbjogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHJlbDogc3RyaW5nO1xuICBmb3JtX21ldGhvZDogc3RyaW5nO1xuICBlbmN0eXBlOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgZmllbGRzOiBhbnksXG4gICAgYWN0aW9uOiBzdHJpbmcsXG4gICAgbmFtZTogc3RyaW5nLFxuICAgIHJlbDogc3RyaW5nLFxuICAgIGZvcm1fbWV0aG9kOiBzdHJpbmcsXG4gICAgZW5jdHlwZTogc3RyaW5nXG4gICkge1xuICAgIHRoaXMuZmllbGRzID0gZmllbGRzO1xuICAgIHRoaXMuYWN0aW9uID0gYWN0aW9uO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5yZWwgPSByZWw7XG4gICAgdGhpcy5mb3JtX21ldGhvZCA9IGZvcm1fbWV0aG9kO1xuICAgIHRoaXMuZW5jdHlwZSA9IGVuY3R5cGU7XG4gIH1cblxuICBnZXRGaWVsZChmaWVsZDogc3RyaW5nKTogSUZpZWxkIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5maWVsZHNbZmllbGRdO1xuICB9XG5cbiAgZ2V0RmllbGRTYWZlKGZpZWxkOiBzdHJpbmcpOiBJRmllbGQge1xuICAgIGNvbnN0IGYgPSB0aGlzLmZpZWxkc1tmaWVsZF07XG4gICAgaWYoIWYpIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBmaWVsZCAke2Z9IGluIGZvcm0gZmllbGRzICR7dGhpcy5maWVsZHN9YCk7XG4gICAgcmV0dXJuIGY7XG4gIH1cbn1cblxuaW50ZXJmYWNlIElTZWFyY2hGb3JtIHtcbiAgYXBpOiBJQXBpO1xuICBmb3JtOiBJRm9ybTtcbiAgZGF0YTogYW55O1xuXG4gIHNldChmaWVsZDogc3RyaW5nLCB2YWx1ZTogYW55KTogSVNlYXJjaEZvcm07XG4gIHJlZihyZWY6IHN0cmluZyk6IElTZWFyY2hGb3JtO1xuICBxdWVyeShxdWVyeTogc3RyaW5nIHwgSVByZWRpY2F0ZSB8IElQcmVkaWNhdGVbXSk6IElTZWFyY2hGb3JtO1xuICBwYWdlU2l6ZShzaXplOiBudW1iZXIpOiBJU2VhcmNoRm9ybTtcbiAgZmV0Y2goZmllbGRzOiBzdHJpbmcgfCBzdHJpbmdbXSk6IElTZWFyY2hGb3JtO1xuICBmZXRjaExpbmtzKGZpZWxkczogc3RyaW5nIHwgc3RyaW5nW10pOiBJU2VhcmNoRm9ybTtcbiAgbGFuZyhsYW5nQ29kZTogc3RyaW5nKTogSVNlYXJjaEZvcm07XG4gIHBhZ2UocDogbnVtYmVyKTogSVNlYXJjaEZvcm07XG4gIG9yZGVyaW5ncyhvcmRlcmluZ3MgPzogc3RyaW5nW10pOiBJU2VhcmNoRm9ybTtcbiAgc3VibWl0KGNhbGxiYWNrOiAoZXJyb3I6IEVycm9yIHwgbnVsbCwgcmVzcG9uc2U6IElBcGlSZXNwb25zZSwgeGhyOiBhbnkpID0+IHZvaWQpOiBhbnk7XG59XG5cbmV4cG9ydCBjbGFzcyBTZWFyY2hGb3JtIGltcGxlbWVudHMgSVNlYXJjaEZvcm0ge1xuICBhcGk6IElBcGk7XG4gIGZvcm06IElGb3JtO1xuICBkYXRhOiBhbnk7XG5cbiAgY29uc3RydWN0b3IoYXBpOiBJQXBpLCBmb3JtOiBJRm9ybSwgZGF0YTogYW55KSB7XG4gICAgdGhpcy5hcGkgPSBhcGk7XG4gICAgdGhpcy5mb3JtID0gZm9ybTtcbiAgICB0aGlzLmRhdGEgPSBkYXRhIHx8IHt9O1xuXG4gICAgZm9yKHZhciBmaWVsZCBpbiBmb3JtLmZpZWxkcykge1xuICAgICAgaWYoZm9ybS5nZXRGaWVsZFNhZmUoZmllbGQpWydkZWZhdWx0J10pIHtcbiAgICAgICAgdGhpcy5kYXRhW2ZpZWxkXSA9IFtmb3JtLmZpZWxkc1tmaWVsZF1bJ2RlZmF1bHQnXV07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc2V0KGZpZWxkOiBzdHJpbmcsIHZhbHVlOiBhbnkpOiBJU2VhcmNoRm9ybSB7XG4gICAgY29uc3QgZmllbGREZXNjID0gdGhpcy5mb3JtLmdldEZpZWxkKGZpZWxkKTtcblxuICAgIGlmKCFmaWVsZERlc2MpIHRocm93IG5ldyBFcnJvcihcIlVua25vd24gZmllbGQgXCIgKyBmaWVsZCk7XG5cbiAgICBjb25zdCBjaGVja2VkVmFsdWUgPSAoKSA9PiB2YWx1ZSA9PT0gJycgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCA/IG51bGwgOiB2YWx1ZTtcbiAgICBjb25zdCB2YWx1ZXMgPSAoKCkgPT4ge1xuICAgICAgY29uc3QgZGVmYXVsdFZhbHVlcyA9IHRoaXMuZGF0YVtmaWVsZF0gfHwgW107XG4gICAgICBpZihmaWVsZERlc2MubXVsdGlwbGUpIHtcbiAgICAgICAgcmV0dXJuIGNoZWNrZWRWYWx1ZSA/IGRlZmF1bHRWYWx1ZXMuY29uY2F0KFtjaGVja2VkVmFsdWVdKSA6IGRlZmF1bHRWYWx1ZXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gY2hlY2tlZFZhbHVlID8gW2NoZWNrZWRWYWx1ZV0gOiBkZWZhdWx0VmFsdWVzO1xuICAgICAgfVxuICAgIH0pKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyBhIHJlZiB0byBxdWVyeSBvbiBmb3IgdGhpcyBTZWFyY2hGb3JtLiBUaGlzIGlzIGEgbWFuZGF0b3J5XG4gICAqIG1ldGhvZCB0byBjYWxsIGJlZm9yZSBjYWxsaW5nIHN1Ym1pdCgpLCBhbmQgYXBpLmZvcm0oJ2V2ZXJ5dGhpbmcnKS5zdWJtaXQoKVxuICAgKiB3aWxsIG5vdCB3b3JrLlxuICAgKi9cbiAgcmVmKHJlZjogc3RyaW5nKTogSVNlYXJjaEZvcm0ge1xuICAgIHJldHVybiB0aGlzLnNldChcInJlZlwiLCByZWYpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgYSBwcmVkaWNhdGUtYmFzZWQgcXVlcnkgZm9yIHRoaXMgU2VhcmNoRm9ybS4gVGhpcyBpcyB3aGVyZSB5b3VcbiAgICogcGFzdGUgd2hhdCB5b3UgY29tcG9zZSBpbiB5b3VyIHByaXNtaWMuaW8gQVBJIGJyb3dzZXIuXG4gICAqL1xuICBxdWVyeShxdWVyeTogc3RyaW5nIHwgSVByZWRpY2F0ZSB8IElQcmVkaWNhdGVbXSk6IElTZWFyY2hGb3JtIHtcbiAgICBpZiAodHlwZW9mIHF1ZXJ5ID09PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIHRoaXMuc2V0KFwicVwiLCBxdWVyeSk7XG4gICAgfSBlbHNlIGlmKHF1ZXJ5IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgIGNvbnN0IHByZWRpY2F0ZXMgPSBxdWVyeS5tYXAoKHByZWRpY2F0ZTogSVByZWRpY2F0ZSkgPT4ge1xuICAgICAgICByZXR1cm4gcHJlZGljYXRlLnRvU3RyaW5nKCk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzLnF1ZXJ5KGBbJHtwcmVkaWNhdGVzLmpvaW4oXCJcIil9XWApO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5xdWVyeShbcXVlcnldKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0cyBhIHBhZ2Ugc2l6ZSB0byBxdWVyeSBmb3IgdGhpcyBTZWFyY2hGb3JtLiBUaGlzIGlzIGFuIG9wdGlvbmFsIG1ldGhvZC5cbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNpemUgLSBUaGUgcGFnZSBzaXplXG4gICAqIEByZXR1cm5zIHtTZWFyY2hGb3JtfSAtIFRoZSBTZWFyY2hGb3JtIGl0c2VsZlxuICAgKi9cbiAgcGFnZVNpemUoc2l6ZTogbnVtYmVyKTogSVNlYXJjaEZvcm0ge1xuICAgIHJldHVybiB0aGlzLnNldChcInBhZ2VTaXplXCIsIHNpemUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc3RyaWN0IHRoZSByZXN1bHRzIGRvY3VtZW50IHRvIHRoZSBzcGVjaWZpZWQgZmllbGRzXG4gICAqL1xuICBmZXRjaChmaWVsZHM6IHN0cmluZyB8IHN0cmluZ1tdKTogSVNlYXJjaEZvcm0ge1xuICAgIGNvbnN0IHN0ckZpZWxkcyA9IGZpZWxkcyBpbnN0YW5jZW9mIEFycmF5ID8gZmllbGRzLmpvaW4oXCIsXCIpIDogZmllbGRzO1xuICAgIHJldHVybiB0aGlzLnNldChcImZldGNoXCIsIHN0ckZpZWxkcyk7XG4gIH1cblxuICAvKipcbiAgICogSW5jbHVkZSB0aGUgcmVxdWVzdGVkIGZpZWxkcyBpbiB0aGUgRG9jdW1lbnRMaW5rIGluc3RhbmNlcyBpbiB0aGUgcmVzdWx0XG4gICAqL1xuICBmZXRjaExpbmtzKGZpZWxkczogc3RyaW5nIHwgc3RyaW5nW10pOiBJU2VhcmNoRm9ybSB7XG4gICAgY29uc3Qgc3RyRmllbGRzID0gZmllbGRzIGluc3RhbmNlb2YgQXJyYXkgPyBmaWVsZHMuam9pbihcIixcIikgOiBmaWVsZHM7XG4gICAgcmV0dXJuIHRoaXMuc2V0KFwiZmV0Y2hMaW5rc1wiLCBzdHJGaWVsZHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIGxhbmd1YWdlIHRvIHF1ZXJ5IGZvciB0aGlzIFNlYXJjaEZvcm0uIFRoaXMgaXMgYW4gb3B0aW9uYWwgbWV0aG9kLlxuICAgKi9cbiAgbGFuZyhsYW5nQ29kZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuc2V0KFwibGFuZ1wiLCBsYW5nQ29kZSk7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgcGFnZSBudW1iZXIgdG8gcXVlcnkgZm9yIHRoaXMgU2VhcmNoRm9ybS4gVGhpcyBpcyBhbiBvcHRpb25hbCBtZXRob2QuXG4gICAqL1xuICBwYWdlKHA6IG51bWJlcik6IElTZWFyY2hGb3JtIHtcbiAgICByZXR1cm4gdGhpcy5zZXQoXCJwYWdlXCIsIHApO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIG9yZGVyaW5ncyB0byBxdWVyeSBmb3IgdGhpcyBTZWFyY2hGb3JtLiBUaGlzIGlzIGFuIG9wdGlvbmFsIG1ldGhvZC5cbiAgICovXG4gIG9yZGVyaW5ncyhvcmRlcmluZ3MgPzogc3RyaW5nW10pOiBJU2VhcmNoRm9ybSB7XG4gICAgaWYgKCFvcmRlcmluZ3MpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5zZXQoXCJvcmRlcmluZ3NcIiwgYFske29yZGVyaW5ncy5qb2luKFwiLFwiKX1dYCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFN1Ym1pdHMgdGhlIHF1ZXJ5LCBhbmQgY2FsbHMgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uLlxuICAgKi9cbiAgc3VibWl0KGNhbGxiYWNrOiAoZXJyb3I6IEVycm9yIHwgbnVsbCwgcmVzcG9uc2U6IElBcGlSZXNwb25zZSwgeGhyOiBhbnkpID0+IHZvaWQpOiBhbnkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgdXJsID0gdGhpcy5mb3JtLmFjdGlvbjtcblxuICAgIGlmICh0aGlzLmRhdGEpIHtcbiAgICAgIHZhciBzZXAgPSAodXJsLmluZGV4T2YoJz8nKSA+IC0xID8gJyYnIDogJz8nKTtcbiAgICAgIGZvcih2YXIga2V5IGluIHRoaXMuZGF0YSkge1xuICAgICAgICBpZiAodGhpcy5kYXRhLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy5kYXRhW2tleV07XG4gICAgICAgICAgaWYgKHZhbHVlcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgdXJsICs9IHNlcCArIGtleSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZXNbaV0pO1xuICAgICAgICAgICAgICBzZXAgPSAnJic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuYXBpLnJlcXVlc3RIYW5kbGVyLnJlcXVlc3QodXJsLCBjYWxsYmFjayk7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBJQXBpUmVzcG9uc2Uge1xuICBwYWdlOiBudW1iZXI7XG4gIHJlc3VsdHNfcGVyX3BhZ2U6IG51bWJlcjtcbiAgcmVzdWx0c19zaXplOiBudW1iZXI7XG4gIHRvdGFsX3Jlc3VsdHNfc2l6ZTogbnVtYmVyO1xuICB0b3RhbF9wYWdlczogbnVtYmVyO1xuICBuZXh0X3BhZ2U6IHN0cmluZztcbiAgcHJldl9wYWdlOiBzdHJpbmc7XG4gIHJlc3VsdHM6IElEb2N1bWVudFtdO1xufVxuXG5leHBvcnQgY2xhc3MgQXBpUmVzcG9uc2Uge1xuICBwYWdlOiBudW1iZXI7XG4gIHJlc3VsdHNfcGVyX3BhZ2U6IG51bWJlcjtcbiAgcmVzdWx0c19zaXplOiBudW1iZXI7XG4gIHRvdGFsX3Jlc3VsdHNfc2l6ZTogbnVtYmVyO1xuICB0b3RhbF9wYWdlczogbnVtYmVyO1xuICBuZXh0X3BhZ2U6IHN0cmluZztcbiAgcHJldl9wYWdlOiBzdHJpbmc7XG4gIHJlc3VsdHM6IElEb2N1bWVudFtdO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHBhZ2U6IG51bWJlcixcbiAgICByZXN1bHRzX3Blcl9wYWdlOiBudW1iZXIsXG4gICAgcmVzdWx0c19zaXplOiBudW1iZXIsXG4gICAgdG90YWxfcmVzdWx0c19zaXplOiBudW1iZXIsXG4gICAgdG90YWxfcGFnZXM6IG51bWJlcixcbiAgICBuZXh0X3BhZ2U6IHN0cmluZyxcbiAgICBwcmV2X3BhZ2U6IHN0cmluZyxcbiAgICByZXN1bHRzOiBJRG9jdW1lbnRbXVxuICApIHtcbiAgICB0aGlzLnBhZ2UgPSBwYWdlO1xuICAgIHRoaXMucmVzdWx0c19wZXJfcGFnZSA9IHJlc3VsdHNfcGVyX3BhZ2U7XG4gICAgdGhpcy5yZXN1bHRzX3NpemUgPSByZXN1bHRzX3NpemU7XG4gICAgdGhpcy50b3RhbF9yZXN1bHRzX3NpemUgPSB0b3RhbF9yZXN1bHRzX3NpemU7XG4gICAgdGhpcy50b3RhbF9wYWdlcyA9IHRvdGFsX3BhZ2VzO1xuICAgIHRoaXMubmV4dF9wYWdlID0gbmV4dF9wYWdlO1xuICAgIHRoaXMucHJldl9wYWdlID0gcHJldl9wYWdlO1xuICAgIHRoaXMucmVzdWx0cyA9IHJlc3VsdHM7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBJQXBpT3B0aW9ucyB7XG4gIGFjY2Vzc1Rva2VuOiBzdHJpbmc7XG4gIGNvbXBsZXRlPzogKGVycjogRXJyb3IgfCBudWxsLCB2YWx1ZT86IGFueSwgeGhyPzogYW55KSA9PiB2b2lkO1xuICByZXF1ZXN0SGFuZGxlcj86IElSZXF1ZXN0SGFuZGxlcjtcbiAgYXBpQ2FjaGU/OiBJQXBpQ2FjaGU7XG4gIGFwaURhdGFUVEw/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUFwaSB7XG4gIHVybDogc3RyaW5nO1xuICBhY2Nlc3NUb2tlbjogc3RyaW5nO1xuICBhcGlDYWNoZUtleTogc3RyaW5nO1xuICBhcGlDYWNoZTogSUFwaUNhY2hlO1xuICBhcGlEYXRhVFRMOiBudW1iZXI7XG4gIHJlcXVlc3RIYW5kbGVyOiBJUmVxdWVzdEhhbmRsZXI7XG4gIGV4cGVyaW1lbnRzOiBJRXhwZXJpbWVudHM7XG4gIGJvb2ttYXJrczogc3RyaW5nW107XG4gIGRhdGE6IGFueTtcbiAgZm9ybXM6IElGb3JtW107XG59XG5cbmV4cG9ydCBjbGFzcyBBcGkgaW1wbGVtZW50cyBJQXBpIHtcbiAgdXJsOiBzdHJpbmc7XG4gIGFjY2Vzc1Rva2VuOiBzdHJpbmc7XG4gIGFwaUNhY2hlS2V5OiBzdHJpbmc7XG4gIGFwaUNhY2hlOiBJQXBpQ2FjaGU7XG4gIGFwaURhdGFUVEw6IG51bWJlcjtcbiAgcmVxdWVzdEhhbmRsZXI6IElSZXF1ZXN0SGFuZGxlcjtcbiAgZXhwZXJpbWVudHM6IElFeHBlcmltZW50cztcbiAgYm9va21hcmtzOiBzdHJpbmdbXTtcbiAgZGF0YTogYW55O1xuICBmb3JtczogSUZvcm1bXTtcblxuICBjb25zdHJ1Y3Rvcih1cmw6IHN0cmluZywgb3B0aW9uczogSUFwaU9wdGlvbnMpIHtcbiAgICB2YXIgb3B0cyA9IG9wdGlvbnMgfHwge307XG4gICAgdGhpcy5hY2Nlc3NUb2tlbiA9IG9wdHMuYWNjZXNzVG9rZW47XG4gICAgdGhpcy51cmwgPSB1cmwgKyAodGhpcy5hY2Nlc3NUb2tlbiA/ICh1cmwuaW5kZXhPZignPycpID4gLTEgPyAnJicgOiAnPycpICsgJ2FjY2Vzc190b2tlbj0nICsgdGhpcy5hY2Nlc3NUb2tlbiA6ICcnKTtcbiAgICB0aGlzLmFwaUNhY2hlID0gb3B0cy5hcGlDYWNoZSB8fCBuZXcgRGVmYXVsdEFwaUNhY2hlKCk7XG4gICAgdGhpcy5yZXF1ZXN0SGFuZGxlciA9IG9wdHMucmVxdWVzdEhhbmRsZXIgfHwgbmV3IERlZmF1bHRSZXF1ZXN0SGFuZGxlcigpO1xuICAgIHRoaXMuYXBpQ2FjaGVLZXkgPSB0aGlzLnVybCArICh0aGlzLmFjY2Vzc1Rva2VuID8gKCcjJyArIHRoaXMuYWNjZXNzVG9rZW4pIDogJycpO1xuICAgIHRoaXMuYXBpRGF0YVRUTCA9IG9wdHMuYXBpRGF0YVRUTCB8fCA1O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIC8qKlxuICAgKiBGZXRjaGVzIGRhdGEgdXNlZCB0byBjb25zdHJ1Y3QgdGhlIGFwaSBjbGllbnQsIGZyb20gY2FjaGUgaWYgaXQnc1xuICAgKiBwcmVzZW50LCBvdGhlcndpc2UgZnJvbSBjYWxsaW5nIHRoZSBwcmlzbWljIGFwaSBlbmRwb2ludCAod2hpY2ggaXNcbiAgICogdGhlbiBjYWNoZWQpLlxuICAgKi9cbiAgZ2V0KGNhbGxiYWNrOiAoZXJyOiBFcnJvciB8IG51bGwsIHZhbHVlPzogYW55LCB4aHI/OiBhbnksIHR0bD86IG51bWJlcikgPT4gdm9pZCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgY2FjaGVLZXkgPSB0aGlzLmFwaUNhY2hlS2V5O1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciBjYiA9IGZ1bmN0aW9uKGVycjogRXJyb3IgfCBudWxsLCB2YWx1ZT86IGFueSwgeGhyPzogYW55LCB0dGw/OiBudW1iZXIpIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjayhlcnIsIHZhbHVlLCB4aHIsIHR0bCk7XG4gICAgICAgIGlmICh2YWx1ZSkgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICAgIGlmIChlcnIpIHJlamVjdChlcnIpO1xuICAgICAgfTtcbiAgICAgIHNlbGYuYXBpQ2FjaGUuZ2V0KGNhY2hlS2V5LCBmdW5jdGlvbiAoZXJyOiBFcnJvciwgdmFsdWU6IGFueSkge1xuICAgICAgICBpZiAoZXJyIHx8IHZhbHVlKSB7XG4gICAgICAgICAgY2IoZXJyLCB2YWx1ZSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc2VsZi5yZXF1ZXN0SGFuZGxlci5yZXF1ZXN0KHNlbGYudXJsLCBmdW5jdGlvbihlcnI6IEVycm9yIHwgbnVsbCwgdmFsdWU/OiBhbnksIHhocj86IGFueSwgdHRsPzogbnVtYmVyKSB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY2IoZXJyLCBudWxsLCB4aHIsIHR0bCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHBhcnNlZCA9IHNlbGYucGFyc2UodmFsdWUpO1xuICAgICAgICAgIHR0bCA9IHR0bCB8fCBzZWxmLmFwaURhdGFUVEw7XG5cbiAgICAgICAgICBzZWxmLmFwaUNhY2hlLnNldChjYWNoZUtleSwgcGFyc2VkLCB0dGwsIGZ1bmN0aW9uIChlcnI6IEVycm9yKSB7XG4gICAgICAgICAgICBjYihlcnIsIHBhcnNlZCwgeGhyLCB0dGwpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFucyBhcGkgZGF0YSBmcm9tIHRoZSBjYWNoZSBhbmQgZmV0Y2hlcyBhbiB1cCB0byBkYXRlIGNvcHkuXG4gICAqXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gT3B0aW9uYWwgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgYWZ0ZXIgdGhlIGRhdGEgaGFzIGJlZW4gcmVmcmVzaGVkXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxuICAgKi9cbiAgcmVmcmVzaChjYWxsYmFjazogKGVycjogRXJyb3IgfCBudWxsIHwgdW5kZWZpbmVkLCBkYXRhOiBhbnksIHhocjogYW55KSA9PiB2b2lkKSB7XG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmFwaUNhY2hlS2V5O1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIGNiID0gZnVuY3Rpb24oZXJyPzogRXJyb3IgfCBudWxsLCB2YWx1ZT86IGFueSwgeGhyPzogYW55KSB7XG4gICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soZXJyLCB2YWx1ZSwgeGhyKTtcbiAgICAgICAgaWYgKHZhbHVlKSByZXNvbHZlKHZhbHVlKTtcbiAgICAgICAgaWYgKGVycikgcmVqZWN0KGVycik7XG4gICAgICB9O1xuICAgICAgc2VsZi5hcGlDYWNoZS5yZW1vdmUoY2FjaGVLZXksIChlcnI6IEVycm9yKSA9PiB7XG4gICAgICAgIGlmIChlcnIpIHsgY2IoZXJyKTsgcmV0dXJuOyB9XG5cbiAgICAgICAgc2VsZi5nZXQoZnVuY3Rpb24gKGVycjogRXJyb3IsIGRhdGE6IGFueSkge1xuICAgICAgICAgIGlmIChlcnIpIHsgY2IoZXJyKTsgcmV0dXJuOyB9XG5cbiAgICAgICAgICBzZWxmLmRhdGEgPSBkYXRhO1xuICAgICAgICAgIHNlbGYuYm9va21hcmtzID0gZGF0YS5ib29rbWFya3M7XG4gICAgICAgICAgc2VsZi5leHBlcmltZW50cyA9IG5ldyBFeHBlcmltZW50cyhkYXRhLmV4cGVyaW1lbnRzKTtcblxuICAgICAgICAgIGNiKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2VzIGFuZCByZXR1cm5zIHRoZSAvYXBpIGRvY3VtZW50LlxuICAgKiBUaGlzIGlzIGZvciBpbnRlcm5hbCB1c2UsIGZyb20gb3V0c2lkZSB0aGlzIGtpdCwgeW91IHNob3VsZCBjYWxsIFByaXNtaWMuQXBpKClcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGRhdGEgLSBUaGUgSlNPTiBkb2N1bWVudCByZXNwb25kZWQgb24gdGhlIEFQSSdzIGVuZHBvaW50XG4gICAqIEByZXR1cm5zIHtBcGl9IC0gVGhlIEFwaSBvYmplY3QgdGhhdCBjYW4gYmUgbWFuaXB1bGF0ZWRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHBhcnNlKGRhdGE6IGFueSkge1xuICAgIC8vIFBhcnNlIHRoZSBmb3Jtc1xuICAgIGNvbnN0IGZvcm1zID0gT2JqZWN0LmtleXMoZGF0YS5mb3JtcyB8fCBbXSkucmVkdWNlKChhY2M6IGFueSwga2V5OiBzdHJpbmcsIGk6IG51bWJlcikgPT4ge1xuICAgICAgaWYgKGRhdGEuZm9ybXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICBjb25zdCBmID0gZGF0YS5mb3Jtc1trZXldO1xuXG4gICAgICAgIGlmKHRoaXMuYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICBmLmZpZWxkc1snYWNjZXNzX3Rva2VuJ10gPSB7fTtcbiAgICAgICAgICBmLmZpZWxkc1snYWNjZXNzX3Rva2VuJ11bJ3R5cGUnXSA9ICdzdHJpbmcnO1xuICAgICAgICAgIGYuZmllbGRzWydhY2Nlc3NfdG9rZW4nXVsnZGVmYXVsdCddID0gdGhpcy5hY2Nlc3NUb2tlbjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGZvcm0gPSBuZXcgRm9ybShcbiAgICAgICAgICBmLm5hbWUsXG4gICAgICAgICAgZi5maWVsZHMsXG4gICAgICAgICAgZi5mb3JtX21ldGhvZCxcbiAgICAgICAgICBmLnJlbCxcbiAgICAgICAgICBmLmVuY3R5cGUsXG4gICAgICAgICAgZi5hY3Rpb25cbiAgICAgICAgKTtcblxuICAgICAgICBhY2Nba2V5XSA9IGZvcm07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfVxuICAgIH0sIHt9KTtcblxuICAgIGNvbnN0IHJlZnMgPSBkYXRhLnJlZnMubWFwKChyOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiBuZXcgUmVmKFxuICAgICAgICByLnJlZixcbiAgICAgICAgci5sYWJlbCxcbiAgICAgICAgci5pc01hc3RlclJlZixcbiAgICAgICAgci5zY2hlZHVsZWRBdCxcbiAgICAgICAgci5pZFxuICAgICAgKTtcbiAgICB9KSB8fCBbXTtcblxuICAgIGNvbnN0IG1hc3RlciA9IHJlZnMuZmlsdGVyKChyOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiByLmlzTWFzdGVyID09PSB0cnVlO1xuICAgIH0pO1xuXG4gICAgY29uc3QgdHlwZXMgPSBkYXRhLnR5cGVzO1xuXG4gICAgY29uc3QgdGFncyA9IGRhdGEudGFncztcblxuICAgIGlmIChtYXN0ZXIubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyAoXCJObyBtYXN0ZXIgcmVmLlwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgYm9va21hcmtzOiBkYXRhLmJvb2ttYXJrcyB8fCB7fSxcbiAgICAgIHJlZnM6IHJlZnMsXG4gICAgICBmb3JtczogZm9ybXMsXG4gICAgICBtYXN0ZXI6IG1hc3RlclswXSxcbiAgICAgIHR5cGVzOiB0eXBlcyxcbiAgICAgIHRhZ3M6IHRhZ3MsXG4gICAgICBleHBlcmltZW50czogZGF0YS5leHBlcmltZW50cyxcbiAgICAgIG9hdXRoSW5pdGlhdGU6IGRhdGFbJ29hdXRoX2luaXRpYXRlJ10sXG4gICAgICBvYXV0aFRva2VuOiBkYXRhWydvYXV0aF90b2tlbiddLFxuICAgICAgcXVpY2tSb3V0ZXM6IGRhdGEucXVpY2tSb3V0ZXNcbiAgICB9O1xuXG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHVzZWFibGUgZm9ybSBmcm9tIGl0cyBpZCwgYXMgZGVzY3JpYmVkIGluIHRoZSBSRVNUZnVsIGRlc2NyaXB0aW9uIG9mIHRoZSBBUEkuXG4gICAqIEZvciBpbnN0YW5jZTogYXBpLmZvcm0oXCJldmVyeXRoaW5nXCIpIHdvcmtzIG9uIGV2ZXJ5IHJlcG9zaXRvcnkgKGFzIFwiZXZlcnl0aGluZ1wiIGV4aXN0cyBieSBkZWZhdWx0KVxuICAgKiBZb3UgY2FuIHRoZW4gY2hhaW4gdGhlIGNhbGxzOiBhcGkuZm9ybShcImV2ZXJ5dGhpbmdcIikucXVlcnkoJ1tbOmQgPSBhdChkb2N1bWVudC5pZCwgXCJVa0wwZ011dnpZVUFOQ3BmXCIpXV0nKS5yZWYocmVmKS5zdWJtaXQoKVxuICAgKi9cbiAgZm9ybShmb3JtSWQ6IHN0cmluZyk6IElTZWFyY2hGb3JtIHwgbnVsbCB7XG4gICAgdmFyIGZvcm0gPSB0aGlzLmRhdGEuZm9ybXNbZm9ybUlkXTtcbiAgICBpZihmb3JtKSB7XG4gICAgICByZXR1cm4gbmV3IFNlYXJjaEZvcm0odGhpcywgZm9ybSwge30pO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGV2ZXJ5dGhpbmcoKTogSVNlYXJjaEZvcm0ge1xuICAgIGNvbnN0IGYgPSB0aGlzLmZvcm0oXCJldmVyeXRoaW5nXCIpO1xuICAgIGlmKCFmKSB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIGV2ZXJ5dGhpbmcgZm9ybVwiKTtcbiAgICByZXR1cm4gZjtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgSUQgb2YgdGhlIG1hc3RlciByZWYgb24gdGhpcyBwcmlzbWljLmlvIEFQSS5cbiAgICogRG8gbm90IHVzZSBsaWtlIHRoaXM6IHNlYXJjaEZvcm0ucmVmKGFwaS5tYXN0ZXIoKSkuXG4gICAqIEluc3RlYWQsIHNldCB5b3VyIHJlZiBvbmNlIGluIGEgdmFyaWFibGUsIGFuZCBjYWxsIGl0IHdoZW4geW91IG5lZWQgaXQ7IHRoaXMgd2lsbCBhbGxvdyB0byBjaGFuZ2UgdGhlIHJlZiB5b3UncmUgdmlld2luZyBlYXNpbHkgZm9yIHlvdXIgZW50aXJlIHBhZ2UuXG4gICAqL1xuICBtYXN0ZXIoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhLm1hc3Rlci5yZWY7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgcmVmIElEIGZvciBhIGdpdmVuIHJlZidzIGxhYmVsLlxuICAgKiBEbyBub3QgdXNlIGxpa2UgdGhpczogc2VhcmNoRm9ybS5yZWYoYXBpLnJlZihcIkZ1dHVyZSByZWxlYXNlIGxhYmVsXCIpKS5cbiAgICogSW5zdGVhZCwgc2V0IHlvdXIgcmVmIG9uY2UgaW4gYSB2YXJpYWJsZSwgYW5kIGNhbGwgaXQgd2hlbiB5b3UgbmVlZCBpdDsgdGhpcyB3aWxsIGFsbG93IHRvIGNoYW5nZSB0aGUgcmVmIHlvdSdyZSB2aWV3aW5nIGVhc2lseSBmb3IgeW91ciBlbnRpcmUgcGFnZS5cbiAgICovXG4gIHJlZihsYWJlbDogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgZm9yKHZhciBpPTA7IGk8dGhpcy5kYXRhLnJlZnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmKHRoaXMuZGF0YS5yZWZzW2ldLmxhYmVsID09IGxhYmVsKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEucmVmc1tpXS5yZWY7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50IGV4cGVyaW1lbnQsIG9yIG51bGxcbiAgICovXG4gIGN1cnJlbnRFeHBlcmltZW50KCk6IElFeHBlcmltZW50IHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuZXhwZXJpbWVudHMuY3VycmVudCgpO1xuICB9XG5cbiAgcXVpY2tSb3V0ZXNFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmRhdGEucXVpY2tSb3V0ZXMuZW5hYmxlZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSBxdWljayByb3V0ZXMgZGVmaW5pdGlvbnNcbiAgICovXG4gIHF1aWNrUm91dGVzKGNhbGxiYWNrOiAoZXJyOiBFcnJvciwgZGF0YTogYW55LCB4aHI6IGFueSkgPT4gdm9pZCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB0aGlzLnJlcXVlc3RIYW5kbGVyLnJlcXVlc3Qoc2VsZi5kYXRhLnF1aWNrUm91dGVzLnVybCwgZnVuY3Rpb24oZXJyOiBFcnJvciwgZGF0YTogYW55LCB4aHI6IGFueSkge1xuICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKGVyciwgZGF0YSwgeGhyKTtcbiAgICAgICAgaWYgKGVycikgcmVqZWN0KGVycik7XG4gICAgICAgIGlmIChkYXRhKSByZXNvbHZlKGRhdGEpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUXVlcnkgdGhlIHJlcG9zaXRvcnlcbiAgICogQHBhcmFtIHtzdHJpbmd8YXJyYXl8UHJlZGljYXRlfSB0aGUgcXVlcnkgaXRzZWxmXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBhZGRpdGlvbmFsIHBhcmFtZXRlcnMuIEluIE5vZGVKUywgcGFzcyB0aGUgcmVxdWVzdCBhcyAncmVxJy5cbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2soZXJyLCByZXNwb25zZSlcbiAgICovXG4gIHF1ZXJ5KHE6IHN0cmluZyB8IElQcmVkaWNhdGUgfCBJUHJlZGljYXRlW10sIG9wdGlvbnNPckNhbGxiYWNrOiBvYmplY3QgfCAoKGVycjogRXJyb3IgfCBudWxsLCByZXNwb25zZT86IGFueSkgPT4gdm9pZCksIGNiOiAoZXJyOiBFcnJvciB8IG51bGwsIHJlc3BvbnNlPzogYW55KSA9PiB2b2lkKSB7XG4gICAgICAgIGNvbnN0IHtvcHRpb25zLCBjYWxsYmFja30gPSB0eXBlb2Ygb3B0aW9uc09yQ2FsbGJhY2sgPT09ICdmdW5jdGlvbidcbiAgICAgID8ge29wdGlvbnM6IHt9LCBjYWxsYmFjazogb3B0aW9uc09yQ2FsbGJhY2t9XG4gICAgICA6IHtvcHRpb25zOiBvcHRpb25zT3JDYWxsYmFjayB8fCB7fSwgY2FsbGJhY2s6IGNifTtcblxuICAgIGNvbnN0IG9wdHM6IGFueSA9IG9wdGlvbnM7XG5cbiAgICB2YXIgZm9ybSA9IHRoaXMuZXZlcnl0aGluZygpO1xuICAgIGZvciAodmFyIGtleSBpbiBvcHRzKSB7XG4gICAgICBmb3JtID0gZm9ybS5zZXQoa2V5LCBvcHRzW2tleV0pO1xuICAgIH1cbiAgICBpZiAocSkge1xuICAgICAgZm9ybS5xdWVyeShxKTtcbiAgICB9XG4gICAgcmV0dXJuIGZvcm0uc3VibWl0KGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSB0aGUgZG9jdW1lbnQgcmV0dXJuZWQgYnkgdGhlIGdpdmVuIHF1ZXJ5XG4gICAqIEBwYXJhbSB7c3RyaW5nfGFycmF5fFByZWRpY2F0ZX0gdGhlIHF1ZXJ5XG4gICAqIEBwYXJhbSB7b2JqZWN0fSBhZGRpdGlvbmFsIHBhcmFtZXRlcnMuIEluIE5vZGVKUywgcGFzcyB0aGUgcmVxdWVzdCBhcyAncmVxJy5cbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2soZXJyLCBkb2MpXG4gICAqL1xuICBxdWVyeUZpcnN0KHE6IHN0cmluZyB8IElQcmVkaWNhdGVbXSB8IElQcmVkaWNhdGUsIG9wdGlvbnNPckNhbGxiYWNrOiBvYmplY3QgfCAoKGVycjogRXJyb3IgfCBudWxsLCByZXNwb25zZT86IGFueSkgPT4gdm9pZCksIGNiOiAoZXJyOiBFcnJvciB8IG51bGwsIHJlc3BvbnNlPzogYW55KSA9PiB2b2lkKSB7XG4gICAgY29uc3Qge29wdGlvbnMsIGNhbGxiYWNrfSA9IHR5cGVvZiBvcHRpb25zT3JDYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJ1xuICAgICAgPyB7b3B0aW9uczoge30sIGNhbGxiYWNrOiBvcHRpb25zT3JDYWxsYmFja31cbiAgICAgIDoge29wdGlvbnM6IG9wdGlvbnNPckNhbGxiYWNrIHx8IHt9LCBjYWxsYmFjazogY2J9O1xuXG4gICAgY29uc3Qgb3B0czogYW55ID0gb3B0aW9ucztcbiAgICBvcHRzLnBhZ2UgPSAxO1xuICAgIG9wdHMucGFnZVNpemUgPSAxO1xuICAgIHJldHVybiB0aGlzLnF1ZXJ5KHEsIG9wdHMsIGZ1bmN0aW9uKGVycjogRXJyb3IsIHJlc3BvbnNlOiBhbnkpIHtcbiAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgcmVzdWx0ID0gcmVzcG9uc2UgJiYgcmVzcG9uc2UucmVzdWx0cyAmJiByZXNwb25zZS5yZXN1bHRzWzBdO1xuICAgICAgICBjYWxsYmFjayhlcnIsIHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZTogYW55KXtcbiAgICAgIHJldHVybiByZXNwb25zZSAmJiByZXNwb25zZS5yZXN1bHRzICYmIHJlc3BvbnNlLnJlc3VsdHNbMF07XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgdGhlIGRvY3VtZW50IHdpdGggdGhlIGdpdmVuIGlkXG4gICAqL1xuICBnZXRCeUlEKGlkOiBzdHJpbmcsIG9wdGlvbnM6IGFueSwgY2FsbGJhY2s6IChlcnI6IEVycm9yIHwgbnVsbCwgcmVzcG9uc2U/OiBhbnkpID0+IHZvaWQpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBpZighb3B0aW9ucy5sYW5nKSBvcHRpb25zLmxhbmcgPSAnKic7XG4gICAgcmV0dXJuIHRoaXMucXVlcnlGaXJzdChuZXcgUHJlZGljYXRlcy5hdCgnZG9jdW1lbnQuaWQnLCBpZCksIG9wdGlvbnMsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSBtdWx0aXBsZSBkb2N1bWVudHMgZnJvbSBhbiBhcnJheSBvZiBpZFxuICAgKi9cbiAgZ2V0QnlJRHMoaWRzOiBzdHJpbmdbXSwgb3B0aW9uczogYW55LCBjYWxsYmFjazogKGVycjogRXJyb3IgfCBudWxsLCByZXNwb25zZT86IGFueSkgPT4gdm9pZCkge1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIGlmKCFvcHRpb25zLmxhbmcpIG9wdGlvbnMubGFuZyA9ICcqJztcbiAgICByZXR1cm4gdGhpcy5xdWVyeShuZXcgUHJlZGljYXRlcy5pbignZG9jdW1lbnQuaWQnLCBpZHMpLCBvcHRpb25zLCBjYWxsYmFjayk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgdGhlIGRvY3VtZW50IHdpdGggdGhlIGdpdmVuIHVpZFxuICAgKi9cbiAgZ2V0QnlVSUQodHlwZTogc3RyaW5nLCB1aWQ6IHN0cmluZywgb3B0aW9uczogYW55LCBjYWxsYmFjazogKGVycjogRXJyb3IgfCBudWxsLCByZXNwb25zZT86IGFueSkgPT4gdm9pZCkge1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIGlmKCFvcHRpb25zLmxhbmcpIG9wdGlvbnMubGFuZyA9ICcqJztcbiAgICByZXR1cm4gdGhpcy5xdWVyeUZpcnN0KG5ldyBQcmVkaWNhdGVzLmF0KGBteS4ke3R5cGV9LnVpZGAsIHVpZCksIG9wdGlvbnMsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSB0aGUgc2luZ2xldG9uIGRvY3VtZW50IHdpdGggdGhlIGdpdmVuIHR5cGVcbiAgICovXG4gIGdldFNpbmdsZSh0eXBlOiBzdHJpbmcsIG9wdGlvbnM6IGFueSwgY2FsbGJhY2s6IChlcnI6IEVycm9yIHwgbnVsbCwgcmVzcG9uc2U/OiBhbnkpID0+IHZvaWQpIHtcbiAgICByZXR1cm4gdGhpcy5xdWVyeUZpcnN0KG5ldyBQcmVkaWNhdGVzLmF0KCdkb2N1bWVudC50eXBlJywgdHlwZSksIG9wdGlvbnMsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSB0aGUgZG9jdW1lbnQgd2l0aCB0aGUgZ2l2ZW4gYm9va21hcmtcbiAgICovXG4gIGdldEJvb2ttYXJrKGJvb2ttYXJrOiBzdHJpbmcsIG9wdGlvbnM6IGFueSwgY2FsbGJhY2s6IChlcnI6IEVycm9yIHwgbnVsbCwgcmVzcG9uc2U/OiBhbnkpID0+IHZvaWQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgaWQgPSB0aGlzLmJvb2ttYXJrc1tib29rbWFya107XG4gICAgICBpZiAoaWQpIHtcbiAgICAgICAgcmVzb2x2ZShpZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgZXJyID0gbmV3IEVycm9yKFwiRXJyb3IgcmV0cmlldmluZyBib29rbWFya2VkIGlkXCIpO1xuICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKGVycik7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfVxuICAgIH0pLnRoZW4oZnVuY3Rpb24oaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldEJ5SUQoaWQsIG9wdGlvbnMsIGNhbGxiYWNrKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIFVSTCB0byBkaXNwbGF5IGEgZ2l2ZW4gcHJldmlld1xuICAgKi9cbiAgcHJldmlld1Nlc3Npb24odG9rZW46IHN0cmluZywgbGlua1Jlc29sdmVyOiAoY3R4OiBhbnkpID0+IHN0cmluZywgZGVmYXVsdFVybDogc3RyaW5nLCBjYWxsYmFjazogKGVycjogRXJyb3IgfCBudWxsLCB1cmw/OiBhbnksIHhocj86IGFueSkgPT4gdm9pZCk6IFByb21pc2VMaWtlPHN0cmluZz4ge1xuICAgIHZhciBhcGkgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciBjYiA9IGZ1bmN0aW9uKGVycjogRXJyb3IgfCBudWxsLCB1cmw/OiBzdHJpbmcsIHhocj86IGFueSkge1xuICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKGVyciwgdXJsLCB4aHIpO1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZSh1cmwpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgYXBpLnJlcXVlc3RIYW5kbGVyLnJlcXVlc3QodG9rZW4sIGZ1bmN0aW9uKGVycjogRXJyb3IsIHJlc3VsdDogYW55LCB4aHI6IGFueSkge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY2IoZXJyLCBkZWZhdWx0VXJsLCB4aHIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgIHZhciBtYWluRG9jdW1lbnRJZCA9IHJlc3VsdC5tYWluRG9jdW1lbnQ7XG4gICAgICAgICAgaWYgKCFtYWluRG9jdW1lbnRJZCkge1xuICAgICAgICAgICAgY2IobnVsbCwgZGVmYXVsdFVybCwgeGhyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXBpLmV2ZXJ5dGhpbmcoKS5xdWVyeShuZXcgUHJlZGljYXRlcy5hdChcImRvY3VtZW50LmlkXCIsIG1haW5Eb2N1bWVudElkKSkucmVmKHRva2VuKS5sYW5nKCcqJykuc3VibWl0KGZ1bmN0aW9uKGVycjogRXJyb3IsIHJlc3BvbnNlOiBJQXBpUmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIGNiKGVycik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgIGNiKG51bGwsIGRlZmF1bHRVcmwsIHhocik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGNiKG51bGwsIGxpbmtSZXNvbHZlcihyZXNwb25zZS5yZXN1bHRzWzBdKSwgeGhyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjYihlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgY2IoZSwgZGVmYXVsdFVybCwgeGhyKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRmV0Y2ggYSBVUkwgY29ycmVzcG9uZGluZyB0byBhIHF1ZXJ5LCBhbmQgcGFyc2UgdGhlIHJlc3BvbnNlIGFzIGEgUmVzcG9uc2Ugb2JqZWN0XG4gICAqL1xuICByZXF1ZXN0KHVybDogc3RyaW5nLCBjYWxsYmFjazogKGVycjogRXJyb3IgfCBudWxsLCByZXN1bHRzOiBJQXBpUmVzcG9uc2UgfCBudWxsLCB4aHI/OiBhbnkpID0+IHZvaWQpOiBQcm9taXNlTGlrZTxJQXBpUmVzcG9uc2U+IHtcbiAgICB2YXIgYXBpID0gdGhpcztcbiAgICB2YXIgY2FjaGVLZXkgPSB1cmwgKyAodGhpcy5hY2Nlc3NUb2tlbiA/ICgnIycgKyB0aGlzLmFjY2Vzc1Rva2VuKSA6ICcnKTtcbiAgICB2YXIgY2FjaGUgPSB0aGlzLmFwaUNhY2hlO1xuICAgIGZ1bmN0aW9uIHJ1bihjYjogKGVycjogRXJyb3IgfCBudWxsLCByZXN1bHRzOiBJQXBpUmVzcG9uc2UgfCBudWxsLCB4aHI/OiBhbnkpID0+IHZvaWQpIHtcbiAgICAgIGNhY2hlLmdldChjYWNoZUtleSwgZnVuY3Rpb24gKGVycjogRXJyb3IsIHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKGVyciB8fCB2YWx1ZSkge1xuICAgICAgICAgIGNiKGVyciwgYXBpLnJlc3BvbnNlKHZhbHVlKSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGFwaS5yZXF1ZXN0SGFuZGxlci5yZXF1ZXN0KHVybCwgZnVuY3Rpb24oZXJyOiBFcnJvciwgZG9jdW1lbnRzOiBhbnksIHhocjogYW55LCB0dGw/OiBudW1iZXIpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBjYihlcnIsIG51bGwsIHhocik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHR0bCkge1xuICAgICAgICAgICAgY2FjaGUuc2V0KGNhY2hlS2V5LCBkb2N1bWVudHMsIHR0bCwgZnVuY3Rpb24gKGVycjogRXJyb3IpIHtcbiAgICAgICAgICAgICAgY2IoZXJyLCBhcGkucmVzcG9uc2UoZG9jdW1lbnRzKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2IobnVsbCwgYXBpLnJlc3BvbnNlKGRvY3VtZW50cykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcnVuKGZ1bmN0aW9uKGVyciwgdmFsdWUsIHhocikge1xuICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKGVyciwgdmFsdWUsIHhocik7XG4gICAgICAgIGlmIChlcnIpIHJlamVjdChlcnIpO1xuICAgICAgICBpZiAodmFsdWUpIHJlc29sdmUodmFsdWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBnZXROZXh0UGFnZShuZXh0UGFnZTogbnVtYmVyLCBjYWxsYmFjazogKGVycjogRXJyb3IgfCBudWxsLCByZXN1bHRzOiBJQXBpUmVzcG9uc2UgfCBudWxsLCB4aHI/OiBhbnkpID0+IHZvaWQpIHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KG5leHRQYWdlICsgKHRoaXMuYWNjZXNzVG9rZW4gPyAnJmFjY2Vzc190b2tlbj0nICsgdGhpcy5hY2Nlc3NUb2tlbiA6ICcnKSwgY2FsbGJhY2spO1xuICB9XG5cbiAgLyoqXG4gICAqIEpTT04gZG9jdW1lbnRzIHRvIFJlc3BvbnNlIG9iamVjdFxuICAgKi9cbiAgcmVzcG9uc2UoZG9jdW1lbnRzOiBhbnkpe1xuICAgIHJldHVybiBuZXcgQXBpUmVzcG9uc2UoXG4gICAgICBkb2N1bWVudHMucGFnZSxcbiAgICAgIGRvY3VtZW50cy5yZXN1bHRzX3Blcl9wYWdlLFxuICAgICAgZG9jdW1lbnRzLnJlc3VsdHNfc2l6ZSxcbiAgICAgIGRvY3VtZW50cy50b3RhbF9yZXN1bHRzX3NpemUsXG4gICAgICBkb2N1bWVudHMudG90YWxfcGFnZXMsXG4gICAgICBkb2N1bWVudHMubmV4dF9wYWdlLFxuICAgICAgZG9jdW1lbnRzLnByZXZfcGFnZSxcbiAgICAgIGRvY3VtZW50cy5yZXN1bHRzIHx8IFtdKTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2FwaS50cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFXQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQWRBO0FBa0NBO0FBUUE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFqQ0E7QUFvREE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUF2SUE7QUFvSkE7QUFVQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUE3QkE7QUFvREE7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFPQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQVNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFPQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQUtBO0FBQ0E7QUFDQTs7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7O0FBS0E7QUFDQTtBQUNBOztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUFBO0FBaGJBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),
/* 5 */
/* unknown exports provided */
/* all exports used */
/*!**********************!*\
  !*** ./src/cache.ts ***!
  \**********************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nexports.__esModule = true;\nvar lru_1 = __webpack_require__(/*! ./lru */ 7);\nvar DefaultApiCache = (function () {\n    function DefaultApiCache(limit) {\n        this.lru = lru_1.MakeLRUCache(limit);\n    }\n    DefaultApiCache.prototype.isExpired = function (key) {\n        var entryValue = this.lru.get(key, false);\n        if (entryValue) {\n            return entryValue.expiredIn !== 0 && entryValue.expiredIn < Date.now();\n        }\n        else {\n            return false;\n        }\n    };\n    DefaultApiCache.prototype.get = function (key, cb) {\n        var entryValue = this.lru.get(key, false);\n        if (entryValue && !this.isExpired(key)) {\n            cb(null, entryValue.data);\n        }\n        cb();\n    };\n    DefaultApiCache.prototype.set = function (key, value, ttl, cb) {\n        this.lru.remove(key);\n        this.lru.put(key, {\n            data: value,\n            expiredIn: ttl ? (Date.now() + (ttl * 1000)) : 0\n        });\n    };\n    DefaultApiCache.prototype.remove = function (key, cb) {\n        this.lru.remove(key);\n        cb();\n    };\n    DefaultApiCache.prototype.clear = function (cb) {\n        this.lru.removeAll();\n        cb();\n    };\n    return DefaultApiCache;\n}());\nexports.DefaultApiCache = DefaultApiCache;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9jYWNoZS50cz84N2I3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElMUlVDYWNoZSwgTWFrZUxSVUNhY2hlIH0gZnJvbSAnLi9scnUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIElBcGlDYWNoZSB7XG4gIGlzRXhwaXJlZChrZXk6IFN0cmluZyk6IGJvb2xlYW47XG4gIGdldChrZXk6IHN0cmluZywgY2I6IChlcnJvciA/OiBFcnJvciB8IG51bGwsIGVudHJ5PzogYW55KSA9PiBhbnkpOiB2b2lkO1xuICBzZXQoa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnksIHR0bDogbnVtYmVyLCBjYjogKGVycm9yID86IEVycm9yIHwgbnVsbCwgZW50cnk/OiBhbnkpID0+IGFueSk6IHZvaWQ7XG4gIHJlbW92ZShrZXk6IHN0cmluZywgY2I6IChlcnJvciA/OiBFcnJvciB8IG51bGwpID0+IGFueSk6IHZvaWQ7XG4gIGNsZWFyKGNiOiAoZXJyb3IgPzogRXJyb3IgfCBudWxsKSA9PiBhbnkpOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgRGVmYXVsdEFwaUNhY2hlIGltcGxlbWVudHMgSUFwaUNhY2hlIHtcbiAgbHJ1OiBJTFJVQ2FjaGU7XG5cbiAgY29uc3RydWN0b3IobGltaXQgPzogbnVtYmVyKSB7XG4gICAgdGhpcy5scnUgPSBNYWtlTFJVQ2FjaGUobGltaXQpO1xuICB9XG5cbiAgaXNFeHBpcmVkKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3QgZW50cnlWYWx1ZSA9IHRoaXMubHJ1LmdldChrZXksIGZhbHNlKTtcbiAgICBpZihlbnRyeVZhbHVlKSB7XG4gICAgICByZXR1cm4gZW50cnlWYWx1ZS5leHBpcmVkSW4gIT09IDAgJiYgZW50cnlWYWx1ZS5leHBpcmVkSW4gPCBEYXRlLm5vdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgZ2V0KGtleTogc3RyaW5nLCBjYjogKGVycm9yID86IEVycm9yIHwgbnVsbCwgZW50cnk/OiBhbnkpID0+IGFueSk6IHZvaWQge1xuICAgIGNvbnN0IGVudHJ5VmFsdWUgPSB0aGlzLmxydS5nZXQoa2V5LCBmYWxzZSk7XG4gICAgaWYoZW50cnlWYWx1ZSAmJiAhdGhpcy5pc0V4cGlyZWQoa2V5KSkge1xuICAgICAgY2IobnVsbCwgZW50cnlWYWx1ZS5kYXRhKTtcbiAgICB9XG4gICAgY2IoKTtcbiAgfVxuXG4gIHNldChrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgdHRsOiBudW1iZXIsIGNiOiAoZXJyb3IgPzogRXJyb3IgfCBudWxsLCBlbnRyeT86IGFueSkgPT4gYW55KTogdm9pZCB7XG4gICAgdGhpcy5scnUucmVtb3ZlKGtleSk7XG4gICAgdGhpcy5scnUucHV0KGtleSwge1xuICAgICAgZGF0YTogdmFsdWUsXG4gICAgICBleHBpcmVkSW46IHR0bCA/IChEYXRlLm5vdygpICsgKHR0bCAqIDEwMDApKSA6IDBcbiAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZShrZXk6IHN0cmluZywgY2I6IChlcnJvciA/OiBFcnJvciB8IG51bGwpID0+IGFueSk6IHZvaWQge1xuICAgIHRoaXMubHJ1LnJlbW92ZShrZXkpO1xuICAgIGNiKCk7XG4gIH1cblxuICBjbGVhcihjYjogKGVycm9yID86IEVycm9yIHwgbnVsbCkgPT4gYW55KTogdm9pZCB7XG4gICAgdGhpcy5scnUucmVtb3ZlQWxsKCk7XG4gICAgY2IoKTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NhY2hlLnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBVUE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUF6Q0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ }),
/* 6 */
/* unknown exports provided */
/* all exports used */
/*!**************************!*\
  !*** ./src/documents.ts ***!
  \**************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nexports.__esModule = true;\nvar Document = (function () {\n    function Document(id, type, href, tags, slug, slugs, alternateLanguages, firstPublicationDate, lastPublicationDate, data, uid, lang) {\n        this.id = id;\n        this.uid = uid;\n        this.type = type;\n        this.href = href;\n        this.tags = tags;\n        this.slug = slug[0];\n        this.slugs = slugs;\n        this.lang = lang;\n        this.alternateLanguages = alternateLanguages;\n        this.firstPublicationDate = firstPublicationDate ? new Date(firstPublicationDate) : null;\n        this.lastPublicationDate = lastPublicationDate ? new Date(lastPublicationDate) : null,\n            this.data = data;\n    }\n    ;\n    return Document;\n}());\nexports.Document = Document;\nvar GroupDoc = (function () {\n    function GroupDoc(data) {\n        this.data = data;\n    }\n    return GroupDoc;\n}());\nexports.GroupDoc = GroupDoc;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9kb2N1bWVudHMudHM/ZjY0YSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgaW50ZXJmYWNlIElEb2N1bWVudCB7XG4gIGlkOiBzdHJpbmc7XG4gIHVpZCA/OiBzdHJpbmc7XG4gIHR5cGU6IHN0cmluZztcbiAgaHJlZjogc3RyaW5nO1xuICB0YWdzOiBzdHJpbmdbXTtcbiAgc2x1Zzogc3RyaW5nO1xuICBzbHVnczogc3RyaW5nW107XG4gIGZpcnN0UHVibGljYXRpb25EYXRlOiBEYXRlIHwgbnVsbDtcbiAgbGFzdFB1YmxpY2F0aW9uRGF0ZTogRGF0ZSB8IG51bGw7XG4gIGxhbmcgPzogc3RyaW5nO1xuICBhbHRlcm5hdGVMYW5ndWFnZXM6IHN0cmluZ1tdO1xuICBkYXRhOiBvYmplY3Q7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUdyb3VwRG9jIHtcbiAgZGF0YTogb2JqZWN0O1xufVxuXG5leHBvcnQgY2xhc3MgRG9jdW1lbnQgaW1wbGVtZW50cyBJRG9jdW1lbnQge1xuICBpZDogc3RyaW5nO1xuICB1aWQgPzogc3RyaW5nO1xuICB0eXBlOiBzdHJpbmc7XG4gIGhyZWY6IHN0cmluZztcbiAgdGFnczogc3RyaW5nW107XG4gIHNsdWc6IHN0cmluZztcbiAgc2x1Z3M6IHN0cmluZ1tdO1xuICBsYW5nID86IHN0cmluZztcbiAgYWx0ZXJuYXRlTGFuZ3VhZ2VzOiBzdHJpbmdbXTtcbiAgZmlyc3RQdWJsaWNhdGlvbkRhdGU6IERhdGUgfCBudWxsO1xuICBsYXN0UHVibGljYXRpb25EYXRlOiBEYXRlIHwgbnVsbDtcbiAgZGF0YTogYW55O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIGlkOiBzdHJpbmcsXG4gICAgdHlwZTogc3RyaW5nLFxuICAgIGhyZWY6IHN0cmluZyxcbiAgICB0YWdzOiBzdHJpbmdbXSxcbiAgICBzbHVnOiBzdHJpbmcsXG4gICAgc2x1Z3M6IHN0cmluZ1tdLFxuICAgIGFsdGVybmF0ZUxhbmd1YWdlczogc3RyaW5nW10sXG4gICAgZmlyc3RQdWJsaWNhdGlvbkRhdGU6IHN0cmluZyB8IG51bGwsXG4gICAgbGFzdFB1YmxpY2F0aW9uRGF0ZTogc3RyaW5nIHwgbnVsbCxcbiAgICBkYXRhOiBhbnksXG4gICAgdWlkID86IHN0cmluZyxcbiAgICBsYW5nID86IHN0cmluZ1xuICApe1xuICAgIFxuICAgIHRoaXMuaWQgPSBpZDtcbiAgICB0aGlzLnVpZCA9IHVpZDtcbiAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgIHRoaXMuaHJlZiA9IGhyZWY7XG4gICAgdGhpcy50YWdzID0gdGFncztcbiAgICB0aGlzLnNsdWcgPSBzbHVnWzBdO1xuICAgIHRoaXMuc2x1Z3MgPSBzbHVncztcbiAgICB0aGlzLmxhbmcgPSBsYW5nO1xuICAgIHRoaXMuYWx0ZXJuYXRlTGFuZ3VhZ2VzID0gYWx0ZXJuYXRlTGFuZ3VhZ2VzO1xuICAgIHRoaXMuZmlyc3RQdWJsaWNhdGlvbkRhdGUgPSBmaXJzdFB1YmxpY2F0aW9uRGF0ZSA/IG5ldyBEYXRlKGZpcnN0UHVibGljYXRpb25EYXRlKSA6IG51bGw7XG4gICAgdGhpcy5sYXN0UHVibGljYXRpb25EYXRlID0gbGFzdFB1YmxpY2F0aW9uRGF0ZSA/IG5ldyBEYXRlKGxhc3RQdWJsaWNhdGlvbkRhdGUpIDogbnVsbCxcbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICB9O1xufVxuXG5leHBvcnQgY2xhc3MgR3JvdXBEb2MgaW1wbGVtZW50cyBJR3JvdXBEb2Mge1xuICBkYXRhOiBhbnk7XG5cbiAgY29uc3RydWN0b3IoZGF0YTogYW55KSB7XG4gICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2RvY3VtZW50cy50cyJdLCJtYXBwaW5ncyI6Ijs7QUFtQkE7QUFjQTtBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBMUNBO0FBNENBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQU5BOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),
/* 7 */
/* unknown exports provided */
/* all exports used */
/*!********************!*\
  !*** ./src/lru.ts ***!
  \********************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n/**\n* A doubly linked list-based Least Recently Used (LRU) cache. Will keep most\n* recently used items while discarding least recently used items when its limit\n* is reached.\n*\n* Licensed under MIT. Copyright (c) 2010 Rasmus Andersson <http://hunch.se/>\n* Typescript-ified by Oleksandr Nikitin <https://tvori.info>\n*\n* Illustration of the design:\n*\n*       entry             entry             entry             entry\n*       ______            ______            ______            ______\n*      | head |.newer => |      |.newer => |      |.newer => | tail |\n*      |  A   |          |  B   |          |  C   |          |  D   |\n*      |______| <= older.|______| <= older.|______| <= older.|______|\n*\n*  removed  <--  <--  <--  <--  <--  <--  <--  <--  <--  <--  <--  added\n*/\nexports.__esModule = true;\nfunction MakeLRUCache(limit) {\n    return new LRUCache(limit);\n}\nexports.MakeLRUCache = MakeLRUCache;\nfunction LRUCache(limit) {\n    // Current size of the cache. (Read-only).\n    this.size = 0;\n    // Maximum number of items this cache can hold.\n    this.limit = limit;\n    this._keymap = {};\n}\n/**\n * Put <value> into the cache associated with <key>. Returns the entry which was\n * removed to make room for the new entry. Otherwise undefined is returned\n * (i.e. if there was enough room already).\n */\nLRUCache.prototype.put = function (key, value) {\n    var entry = { key: key, value: value };\n    // Note: No protection agains replacing, and thus orphan entries. By design.\n    this._keymap[key] = entry;\n    if (this.tail) {\n        // link previous tail to the new tail (entry)\n        this.tail.newer = entry;\n        entry.older = this.tail;\n    }\n    else {\n        // we're first in -- yay\n        this.head = entry;\n    }\n    // add new entry to the end of the linked list -- it's now the freshest entry.\n    this.tail = entry;\n    if (this.size === this.limit) {\n        // we hit the limit -- remove the head\n        return this.shift();\n    }\n    else {\n        // increase the size counter\n        this.size++;\n    }\n};\n/**\n * Purge the least recently used (oldest) entry from the cache. Returns the\n * removed entry or undefined if the cache was empty.\n *\n * If you need to perform any form of finalization of purged items, this is a\n * good place to do it. Simply override/replace this function:\n *\n *   var c = new LRUCache(123);\n *   c.shift = function() {\n *     var entry = LRUCache.prototype.shift.call(this);\n *     doSomethingWith(entry);\n *     return entry;\n *   }\n */\nLRUCache.prototype.shift = function () {\n    // todo: handle special case when limit == 1\n    var entry = this.head;\n    if (entry) {\n        if (this.head.newer) {\n            this.head = this.head.newer;\n            this.head.older = undefined;\n        }\n        else {\n            this.head = undefined;\n        }\n        // Remove last strong reference to <entry> and remove links from the purged\n        // entry being returned:\n        entry.newer = entry.older = undefined;\n        // delete is slow, but we need to do this to avoid uncontrollable growth:\n        delete this._keymap[entry.key];\n    }\n    console.log('purging ', entry.key);\n    return entry;\n};\n/**\n * Get and register recent use of <key>. Returns the value associated with <key>\n * or undefined if not in cache.\n */\nLRUCache.prototype.get = function (key, returnEntry) {\n    // First, find our cache entry\n    var entry = this._keymap[key];\n    if (entry === undefined)\n        return; // Not cached. Sorry.\n    // As <key> was found in the cache, register it as being requested recently\n    if (entry === this.tail) {\n        // Already the most recently used entry, so no need to update the list\n        return returnEntry ? entry : entry.value;\n    }\n    // HEAD--------------TAIL\n    //   <.older   .newer>\n    //  <--- add direction --\n    //   A  B  C  <D>  E\n    if (entry.newer) {\n        if (entry === this.head)\n            this.head = entry.newer;\n        entry.newer.older = entry.older; // C <-- E.\n    }\n    if (entry.older)\n        entry.older.newer = entry.newer; // C. --> E\n    entry.newer = undefined; // D --x\n    entry.older = this.tail; // D. --> E\n    if (this.tail)\n        this.tail.newer = entry; // E. <-- D\n    this.tail = entry;\n    return returnEntry ? entry : entry.value;\n};\n// ----------------------------------------------------------------------------\n// Following code is optional and can be removed without breaking the core\n// functionality.\n/**\n * Check if <key> is in the cache without registering recent use. Feasible if\n * you do not want to chage the state of the cache, but only \"peek\" at it.\n * Returns the entry associated with <key> if found, or undefined if not found.\n */\nLRUCache.prototype.find = function (key) {\n    return this._keymap[key];\n};\n/**\n * Update the value of entry with <key>. Returns the old value, or undefined if\n * entry was not in the cache.\n */\nLRUCache.prototype.set = function (key, value) {\n    var oldvalue;\n    var entry = this.get(key, true);\n    if (entry) {\n        oldvalue = entry.value;\n        entry.value = value;\n    }\n    else {\n        oldvalue = this.put(key, value);\n        if (oldvalue)\n            oldvalue = oldvalue.value;\n    }\n    return oldvalue;\n};\n/**\n * Remove entry <key> from cache and return its value. Returns undefined if not\n * found.\n */\nLRUCache.prototype.remove = function (key) {\n    var entry = this._keymap[key];\n    if (!entry)\n        return;\n    delete this._keymap[entry.key]; // need to do delete unfortunately\n    if (entry.newer && entry.older) {\n        // relink the older entry with the newer entry\n        entry.older.newer = entry.newer;\n        entry.newer.older = entry.older;\n    }\n    else if (entry.newer) {\n        // remove the link to us\n        entry.newer.older = undefined;\n        // link the newer entry to head\n        this.head = entry.newer;\n    }\n    else if (entry.older) {\n        // remove the link to us\n        entry.older.newer = undefined;\n        // link the newer entry to head\n        this.tail = entry.older;\n    }\n    else {\n        this.head = this.tail = undefined;\n    }\n    this.size--;\n    return entry.value;\n};\n/** Removes all entries */\nLRUCache.prototype.removeAll = function () {\n    // This should be safe, as we never expose strong refrences to the outside\n    this.head = this.tail = undefined;\n    this.size = 0;\n    this._keymap = {};\n};\n/**\n * Return an array containing all keys of entries stored in the cache object, in\n * arbitrary order.\n */\nif (typeof Object.keys === 'function') {\n    LRUCache.prototype.keys = function () { return Object.keys(this._keymap); };\n}\nelse {\n    LRUCache.prototype.keys = function () {\n        var keys = [];\n        for (var k in this._keymap)\n            keys.push(k);\n        return keys;\n    };\n}\n/**\n * Call `fun` for each entry. Starting with the newest entry if `desc` is a true\n * value, otherwise starts with the oldest (head) enrty and moves towards the\n * tail.\n *\n * `fun` is called with 3 arguments in the context `context`:\n *   `fun.call(context, Object key, Object value, LRUCache self)`\n */\nLRUCache.prototype.forEach = function (fun, context, desc) {\n    var entry;\n    if (context === true) {\n        desc = true;\n        context = undefined;\n    }\n    else if (typeof context !== 'object')\n        context = this;\n    if (desc) {\n        entry = this.tail;\n        while (entry) {\n            fun.call(context, entry.key, entry.value, this);\n            entry = entry.older;\n        }\n    }\n    else {\n        entry = this.head;\n        while (entry) {\n            fun.call(context, entry.key, entry.value, this);\n            entry = entry.newer;\n        }\n    }\n};\n/** Returns a JSON (array) representation */\n//LRUCache.prototype.toJSON = function () {\n//    var s: IEntry[] = [], entry = this.head;\n//    while (entry) {\n//        s.push({ key: entry.key.toJSON(), value: entry.value.toJSON() });\n//        entry = entry.newer;\n//    }\n//    return s;\n//};\n/** Returns a String representation */\nLRUCache.prototype.toString = function () {\n    var s = '', entry = this.head;\n    while (entry) {\n        s += String(entry.key) + ':' + entry.value;\n        entry = entry.newer;\n        if (entry)\n            s += ' < ';\n    }\n    return s;\n};\n// Export ourselves\n//if (typeof this === 'object') this.LRUCache = LRUCache; \n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9scnUudHM/MWU3OCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiogQSBkb3VibHkgbGlua2VkIGxpc3QtYmFzZWQgTGVhc3QgUmVjZW50bHkgVXNlZCAoTFJVKSBjYWNoZS4gV2lsbCBrZWVwIG1vc3RcbiogcmVjZW50bHkgdXNlZCBpdGVtcyB3aGlsZSBkaXNjYXJkaW5nIGxlYXN0IHJlY2VudGx5IHVzZWQgaXRlbXMgd2hlbiBpdHMgbGltaXRcbiogaXMgcmVhY2hlZC5cbipcbiogTGljZW5zZWQgdW5kZXIgTUlULiBDb3B5cmlnaHQgKGMpIDIwMTAgUmFzbXVzIEFuZGVyc3NvbiA8aHR0cDovL2h1bmNoLnNlLz5cbiogVHlwZXNjcmlwdC1pZmllZCBieSBPbGVrc2FuZHIgTmlraXRpbiA8aHR0cHM6Ly90dm9yaS5pbmZvPlxuKlxuKiBJbGx1c3RyYXRpb24gb2YgdGhlIGRlc2lnbjpcbipcbiogICAgICAgZW50cnkgICAgICAgICAgICAgZW50cnkgICAgICAgICAgICAgZW50cnkgICAgICAgICAgICAgZW50cnlcbiogICAgICAgX19fX19fICAgICAgICAgICAgX19fX19fICAgICAgICAgICAgX19fX19fICAgICAgICAgICAgX19fX19fXG4qICAgICAgfCBoZWFkIHwubmV3ZXIgPT4gfCAgICAgIHwubmV3ZXIgPT4gfCAgICAgIHwubmV3ZXIgPT4gfCB0YWlsIHxcbiogICAgICB8ICBBICAgfCAgICAgICAgICB8ICBCICAgfCAgICAgICAgICB8ICBDICAgfCAgICAgICAgICB8ICBEICAgfFxuKiAgICAgIHxfX19fX198IDw9IG9sZGVyLnxfX19fX198IDw9IG9sZGVyLnxfX19fX198IDw9IG9sZGVyLnxfX19fX198XG4qXG4qICByZW1vdmVkICA8LS0gIDwtLSAgPC0tICA8LS0gIDwtLSAgPC0tICA8LS0gIDwtLSAgPC0tICA8LS0gIDwtLSAgYWRkZWRcbiovXG5cbmV4cG9ydCBmdW5jdGlvbiBNYWtlTFJVQ2FjaGUobGltaXQ6IGFueSk6IElMUlVDYWNoZSB7XG4gICAgcmV0dXJuIG5ldyAoPGFueT5MUlVDYWNoZSkobGltaXQpO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElMUlVDYWNoZSB7XG4gICAgcHV0KGtleTogc3RyaW5nLCB2YWx1ZTogYW55KTogdm9pZDtcbiAgICBnZXQoa2V5OiBzdHJpbmcsIEVudHJ5OiBib29sZWFuKTogYW55O1xuICAgIHJlbW92ZShrZXk6IFN0cmluZyk6IHZvaWQ7XG4gICAgcmVtb3ZlQWxsKCk6IHZvaWQ7XG59XG5cbmZ1bmN0aW9uIExSVUNhY2hlKGxpbWl0OiBudW1iZXIpIHtcbiAgICAvLyBDdXJyZW50IHNpemUgb2YgdGhlIGNhY2hlLiAoUmVhZC1vbmx5KS5cbiAgICB0aGlzLnNpemUgPSAwO1xuICAgIC8vIE1heGltdW0gbnVtYmVyIG9mIGl0ZW1zIHRoaXMgY2FjaGUgY2FuIGhvbGQuXG4gICAgdGhpcy5saW1pdCA9IGxpbWl0O1xuICAgIHRoaXMuX2tleW1hcCA9IHt9O1xufVxuXG5pbnRlcmZhY2UgSUVudHJ5IHtcbiAgICBuZXdlcj86IElFbnRyeTtcbiAgICBvbGRlcj86IElFbnRyeTtcbiAgICBrZXk6IHN0cmluZztcbiAgICB2YWx1ZTogYW55O1xufVxuXG4vKipcbiAqIFB1dCA8dmFsdWU+IGludG8gdGhlIGNhY2hlIGFzc29jaWF0ZWQgd2l0aCA8a2V5Pi4gUmV0dXJucyB0aGUgZW50cnkgd2hpY2ggd2FzXG4gKiByZW1vdmVkIHRvIG1ha2Ugcm9vbSBmb3IgdGhlIG5ldyBlbnRyeS4gT3RoZXJ3aXNlIHVuZGVmaW5lZCBpcyByZXR1cm5lZFxuICogKGkuZS4gaWYgdGhlcmUgd2FzIGVub3VnaCByb29tIGFscmVhZHkpLlxuICovXG5MUlVDYWNoZS5wcm90b3R5cGUucHV0ID0gZnVuY3Rpb24gKGtleTogc3RyaW5nLCB2YWx1ZTogYW55KSB7XG4gICAgdmFyIGVudHJ5OiBJRW50cnkgPSB7IGtleToga2V5LCB2YWx1ZTogdmFsdWUgfTtcbiAgICAvLyBOb3RlOiBObyBwcm90ZWN0aW9uIGFnYWlucyByZXBsYWNpbmcsIGFuZCB0aHVzIG9ycGhhbiBlbnRyaWVzLiBCeSBkZXNpZ24uXG4gICAgdGhpcy5fa2V5bWFwW2tleV0gPSBlbnRyeTtcbiAgICBpZiAodGhpcy50YWlsKSB7XG4gICAgICAgIC8vIGxpbmsgcHJldmlvdXMgdGFpbCB0byB0aGUgbmV3IHRhaWwgKGVudHJ5KVxuICAgICAgICB0aGlzLnRhaWwubmV3ZXIgPSBlbnRyeTtcbiAgICAgICAgZW50cnkub2xkZXIgPSB0aGlzLnRhaWw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gd2UncmUgZmlyc3QgaW4gLS0geWF5XG4gICAgICAgIHRoaXMuaGVhZCA9IGVudHJ5O1xuICAgIH1cbiAgICAvLyBhZGQgbmV3IGVudHJ5IHRvIHRoZSBlbmQgb2YgdGhlIGxpbmtlZCBsaXN0IC0tIGl0J3Mgbm93IHRoZSBmcmVzaGVzdCBlbnRyeS5cbiAgICB0aGlzLnRhaWwgPSBlbnRyeTtcbiAgICBpZiAodGhpcy5zaXplID09PSB0aGlzLmxpbWl0KSB7XG4gICAgICAgIC8vIHdlIGhpdCB0aGUgbGltaXQgLS0gcmVtb3ZlIHRoZSBoZWFkXG4gICAgICAgIHJldHVybiB0aGlzLnNoaWZ0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gaW5jcmVhc2UgdGhlIHNpemUgY291bnRlclxuICAgICAgICB0aGlzLnNpemUrKztcbiAgICB9XG59O1xuXG4vKipcbiAqIFB1cmdlIHRoZSBsZWFzdCByZWNlbnRseSB1c2VkIChvbGRlc3QpIGVudHJ5IGZyb20gdGhlIGNhY2hlLiBSZXR1cm5zIHRoZVxuICogcmVtb3ZlZCBlbnRyeSBvciB1bmRlZmluZWQgaWYgdGhlIGNhY2hlIHdhcyBlbXB0eS5cbiAqXG4gKiBJZiB5b3UgbmVlZCB0byBwZXJmb3JtIGFueSBmb3JtIG9mIGZpbmFsaXphdGlvbiBvZiBwdXJnZWQgaXRlbXMsIHRoaXMgaXMgYVxuICogZ29vZCBwbGFjZSB0byBkbyBpdC4gU2ltcGx5IG92ZXJyaWRlL3JlcGxhY2UgdGhpcyBmdW5jdGlvbjpcbiAqXG4gKiAgIHZhciBjID0gbmV3IExSVUNhY2hlKDEyMyk7XG4gKiAgIGMuc2hpZnQgPSBmdW5jdGlvbigpIHtcbiAqICAgICB2YXIgZW50cnkgPSBMUlVDYWNoZS5wcm90b3R5cGUuc2hpZnQuY2FsbCh0aGlzKTtcbiAqICAgICBkb1NvbWV0aGluZ1dpdGgoZW50cnkpO1xuICogICAgIHJldHVybiBlbnRyeTtcbiAqICAgfVxuICovXG5MUlVDYWNoZS5wcm90b3R5cGUuc2hpZnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gdG9kbzogaGFuZGxlIHNwZWNpYWwgY2FzZSB3aGVuIGxpbWl0ID09IDFcbiAgICB2YXIgZW50cnkgPSB0aGlzLmhlYWQ7XG4gICAgaWYgKGVudHJ5KSB7XG4gICAgICAgIGlmICh0aGlzLmhlYWQubmV3ZXIpIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IHRoaXMuaGVhZC5uZXdlcjtcbiAgICAgICAgICAgIHRoaXMuaGVhZC5vbGRlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICAvLyBSZW1vdmUgbGFzdCBzdHJvbmcgcmVmZXJlbmNlIHRvIDxlbnRyeT4gYW5kIHJlbW92ZSBsaW5rcyBmcm9tIHRoZSBwdXJnZWRcbiAgICAgICAgLy8gZW50cnkgYmVpbmcgcmV0dXJuZWQ6XG4gICAgICAgIGVudHJ5Lm5ld2VyID0gZW50cnkub2xkZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIC8vIGRlbGV0ZSBpcyBzbG93LCBidXQgd2UgbmVlZCB0byBkbyB0aGlzIHRvIGF2b2lkIHVuY29udHJvbGxhYmxlIGdyb3d0aDpcbiAgICAgICAgZGVsZXRlIHRoaXMuX2tleW1hcFtlbnRyeS5rZXldO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZygncHVyZ2luZyAnLCBlbnRyeS5rZXkpO1xuICAgIHJldHVybiBlbnRyeTtcbn07XG5cbi8qKlxuICogR2V0IGFuZCByZWdpc3RlciByZWNlbnQgdXNlIG9mIDxrZXk+LiBSZXR1cm5zIHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdpdGggPGtleT5cbiAqIG9yIHVuZGVmaW5lZCBpZiBub3QgaW4gY2FjaGUuXG4gKi9cbkxSVUNhY2hlLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5OiBzdHJpbmcsIHJldHVybkVudHJ5OiBib29sZWFuKTogYW55IHtcbiAgICAvLyBGaXJzdCwgZmluZCBvdXIgY2FjaGUgZW50cnlcbiAgICB2YXIgZW50cnkgPSB0aGlzLl9rZXltYXBba2V5XTtcbiAgICBpZiAoZW50cnkgPT09IHVuZGVmaW5lZCkgcmV0dXJuOyAvLyBOb3QgY2FjaGVkLiBTb3JyeS5cbiAgICAvLyBBcyA8a2V5PiB3YXMgZm91bmQgaW4gdGhlIGNhY2hlLCByZWdpc3RlciBpdCBhcyBiZWluZyByZXF1ZXN0ZWQgcmVjZW50bHlcbiAgICBpZiAoZW50cnkgPT09IHRoaXMudGFpbCkge1xuICAgICAgICAvLyBBbHJlYWR5IHRoZSBtb3N0IHJlY2VudGx5IHVzZWQgZW50cnksIHNvIG5vIG5lZWQgdG8gdXBkYXRlIHRoZSBsaXN0XG4gICAgICAgIHJldHVybiByZXR1cm5FbnRyeSA/IGVudHJ5IDogZW50cnkudmFsdWU7XG4gICAgfVxuICAgIC8vIEhFQUQtLS0tLS0tLS0tLS0tLVRBSUxcbiAgICAvLyAgIDwub2xkZXIgICAubmV3ZXI+XG4gICAgLy8gIDwtLS0gYWRkIGRpcmVjdGlvbiAtLVxuICAgIC8vICAgQSAgQiAgQyAgPEQ+ICBFXG4gICAgaWYgKGVudHJ5Lm5ld2VyKSB7XG4gICAgICAgIGlmIChlbnRyeSA9PT0gdGhpcy5oZWFkKVxuICAgICAgICAgICAgdGhpcy5oZWFkID0gZW50cnkubmV3ZXI7XG4gICAgICAgIGVudHJ5Lm5ld2VyLm9sZGVyID0gZW50cnkub2xkZXI7IC8vIEMgPC0tIEUuXG4gICAgfVxuICAgIGlmIChlbnRyeS5vbGRlcilcbiAgICAgICAgZW50cnkub2xkZXIubmV3ZXIgPSBlbnRyeS5uZXdlcjsgLy8gQy4gLS0+IEVcbiAgICBlbnRyeS5uZXdlciA9IHVuZGVmaW5lZDsgLy8gRCAtLXhcbiAgICBlbnRyeS5vbGRlciA9IHRoaXMudGFpbDsgLy8gRC4gLS0+IEVcbiAgICBpZiAodGhpcy50YWlsKVxuICAgICAgICB0aGlzLnRhaWwubmV3ZXIgPSBlbnRyeTsgLy8gRS4gPC0tIERcbiAgICB0aGlzLnRhaWwgPSBlbnRyeTtcbiAgICByZXR1cm4gcmV0dXJuRW50cnkgPyBlbnRyeSA6IGVudHJ5LnZhbHVlO1xufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gRm9sbG93aW5nIGNvZGUgaXMgb3B0aW9uYWwgYW5kIGNhbiBiZSByZW1vdmVkIHdpdGhvdXQgYnJlYWtpbmcgdGhlIGNvcmVcbi8vIGZ1bmN0aW9uYWxpdHkuXG5cbi8qKlxuICogQ2hlY2sgaWYgPGtleT4gaXMgaW4gdGhlIGNhY2hlIHdpdGhvdXQgcmVnaXN0ZXJpbmcgcmVjZW50IHVzZS4gRmVhc2libGUgaWZcbiAqIHlvdSBkbyBub3Qgd2FudCB0byBjaGFnZSB0aGUgc3RhdGUgb2YgdGhlIGNhY2hlLCBidXQgb25seSBcInBlZWtcIiBhdCBpdC5cbiAqIFJldHVybnMgdGhlIGVudHJ5IGFzc29jaWF0ZWQgd2l0aCA8a2V5PiBpZiBmb3VuZCwgb3IgdW5kZWZpbmVkIGlmIG5vdCBmb3VuZC5cbiAqL1xuTFJVQ2FjaGUucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbiAoa2V5OiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5fa2V5bWFwW2tleV07XG59O1xuXG4vKipcbiAqIFVwZGF0ZSB0aGUgdmFsdWUgb2YgZW50cnkgd2l0aCA8a2V5Pi4gUmV0dXJucyB0aGUgb2xkIHZhbHVlLCBvciB1bmRlZmluZWQgaWZcbiAqIGVudHJ5IHdhcyBub3QgaW4gdGhlIGNhY2hlLlxuICovXG5MUlVDYWNoZS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGtleTogc3RyaW5nLCB2YWx1ZTogYW55KSB7XG4gICAgdmFyIG9sZHZhbHVlOiBhbnk7XG4gICAgdmFyIGVudHJ5ID0gdGhpcy5nZXQoa2V5LCB0cnVlKTtcbiAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgb2xkdmFsdWUgPSBlbnRyeS52YWx1ZTtcbiAgICAgICAgZW50cnkudmFsdWUgPSB2YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBvbGR2YWx1ZSA9IHRoaXMucHV0KGtleSwgdmFsdWUpO1xuICAgICAgICBpZiAob2xkdmFsdWUpIG9sZHZhbHVlID0gb2xkdmFsdWUudmFsdWU7XG4gICAgfVxuICAgIHJldHVybiBvbGR2YWx1ZTtcbn07XG5cbi8qKlxuICogUmVtb3ZlIGVudHJ5IDxrZXk+IGZyb20gY2FjaGUgYW5kIHJldHVybiBpdHMgdmFsdWUuIFJldHVybnMgdW5kZWZpbmVkIGlmIG5vdFxuICogZm91bmQuXG4gKi9cbkxSVUNhY2hlLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoa2V5OiBzdHJpbmcpIHtcbiAgICB2YXIgZW50cnkgPSB0aGlzLl9rZXltYXBba2V5XTtcbiAgICBpZiAoIWVudHJ5KSByZXR1cm47XG4gICAgZGVsZXRlIHRoaXMuX2tleW1hcFtlbnRyeS5rZXldOyAvLyBuZWVkIHRvIGRvIGRlbGV0ZSB1bmZvcnR1bmF0ZWx5XG4gICAgaWYgKGVudHJ5Lm5ld2VyICYmIGVudHJ5Lm9sZGVyKSB7XG4gICAgICAgIC8vIHJlbGluayB0aGUgb2xkZXIgZW50cnkgd2l0aCB0aGUgbmV3ZXIgZW50cnlcbiAgICAgICAgZW50cnkub2xkZXIubmV3ZXIgPSBlbnRyeS5uZXdlcjtcbiAgICAgICAgZW50cnkubmV3ZXIub2xkZXIgPSBlbnRyeS5vbGRlcjtcbiAgICB9IGVsc2UgaWYgKGVudHJ5Lm5ld2VyKSB7XG4gICAgICAgIC8vIHJlbW92ZSB0aGUgbGluayB0byB1c1xuICAgICAgICBlbnRyeS5uZXdlci5vbGRlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgLy8gbGluayB0aGUgbmV3ZXIgZW50cnkgdG8gaGVhZFxuICAgICAgICB0aGlzLmhlYWQgPSBlbnRyeS5uZXdlcjtcbiAgICB9IGVsc2UgaWYgKGVudHJ5Lm9sZGVyKSB7XG4gICAgICAgIC8vIHJlbW92ZSB0aGUgbGluayB0byB1c1xuICAgICAgICBlbnRyeS5vbGRlci5uZXdlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgLy8gbGluayB0aGUgbmV3ZXIgZW50cnkgdG8gaGVhZFxuICAgICAgICB0aGlzLnRhaWwgPSBlbnRyeS5vbGRlcjtcbiAgICB9IGVsc2Ugey8vIGlmKGVudHJ5Lm9sZGVyID09PSB1bmRlZmluZWQgJiYgZW50cnkubmV3ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmhlYWQgPSB0aGlzLnRhaWwgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdGhpcy5zaXplLS07XG4gICAgcmV0dXJuIGVudHJ5LnZhbHVlO1xufTtcblxuLyoqIFJlbW92ZXMgYWxsIGVudHJpZXMgKi9cbkxSVUNhY2hlLnByb3RvdHlwZS5yZW1vdmVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gVGhpcyBzaG91bGQgYmUgc2FmZSwgYXMgd2UgbmV2ZXIgZXhwb3NlIHN0cm9uZyByZWZyZW5jZXMgdG8gdGhlIG91dHNpZGVcbiAgICB0aGlzLmhlYWQgPSB0aGlzLnRhaWwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zaXplID0gMDtcbiAgICB0aGlzLl9rZXltYXAgPSB7fTtcbn07XG5cbi8qKlxuICogUmV0dXJuIGFuIGFycmF5IGNvbnRhaW5pbmcgYWxsIGtleXMgb2YgZW50cmllcyBzdG9yZWQgaW4gdGhlIGNhY2hlIG9iamVjdCwgaW5cbiAqIGFyYml0cmFyeSBvcmRlci5cbiAqL1xuaWYgKHR5cGVvZiBPYmplY3Qua2V5cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIExSVUNhY2hlLnByb3RvdHlwZS5rZXlzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fa2V5bWFwKTsgfTtcbn0gZWxzZSB7XG4gICAgTFJVQ2FjaGUucHJvdG90eXBlLmtleXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBrZXlzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBrIGluIHRoaXMuX2tleW1hcCkga2V5cy5wdXNoKGspO1xuICAgICAgICByZXR1cm4ga2V5cztcbiAgICB9O1xufVxuXG4vKipcbiAqIENhbGwgYGZ1bmAgZm9yIGVhY2ggZW50cnkuIFN0YXJ0aW5nIHdpdGggdGhlIG5ld2VzdCBlbnRyeSBpZiBgZGVzY2AgaXMgYSB0cnVlXG4gKiB2YWx1ZSwgb3RoZXJ3aXNlIHN0YXJ0cyB3aXRoIHRoZSBvbGRlc3QgKGhlYWQpIGVucnR5IGFuZCBtb3ZlcyB0b3dhcmRzIHRoZVxuICogdGFpbC5cbiAqXG4gKiBgZnVuYCBpcyBjYWxsZWQgd2l0aCAzIGFyZ3VtZW50cyBpbiB0aGUgY29udGV4dCBgY29udGV4dGA6XG4gKiAgIGBmdW4uY2FsbChjb250ZXh0LCBPYmplY3Qga2V5LCBPYmplY3QgdmFsdWUsIExSVUNhY2hlIHNlbGYpYFxuICovXG5MUlVDYWNoZS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChmdW46IEZ1bmN0aW9uLCBjb250ZXh0OiBhbnksIGRlc2M6IGJvb2xlYW4pIHtcbiAgICB2YXIgZW50cnk6IElFbnRyeSB8IHVuZGVmaW5lZDtcbiAgICBpZiAoY29udGV4dCA9PT0gdHJ1ZSkgeyBkZXNjID0gdHJ1ZTsgY29udGV4dCA9IHVuZGVmaW5lZDsgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBjb250ZXh0ICE9PSAnb2JqZWN0JykgY29udGV4dCA9IHRoaXM7XG4gICAgaWYgKGRlc2MpIHtcbiAgICAgICAgZW50cnkgPSB0aGlzLnRhaWw7XG4gICAgICAgIHdoaWxlIChlbnRyeSkge1xuICAgICAgICAgICAgZnVuLmNhbGwoY29udGV4dCwgZW50cnkua2V5LCBlbnRyeS52YWx1ZSwgdGhpcyk7XG4gICAgICAgICAgICBlbnRyeSA9IGVudHJ5Lm9sZGVyO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZW50cnkgPSB0aGlzLmhlYWQ7XG4gICAgICAgIHdoaWxlIChlbnRyeSkge1xuICAgICAgICAgICAgZnVuLmNhbGwoY29udGV4dCwgZW50cnkua2V5LCBlbnRyeS52YWx1ZSwgdGhpcyk7XG4gICAgICAgICAgICBlbnRyeSA9IGVudHJ5Lm5ld2VyO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuLyoqIFJldHVybnMgYSBKU09OIChhcnJheSkgcmVwcmVzZW50YXRpb24gKi9cbi8vTFJVQ2FjaGUucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcbi8vICAgIHZhciBzOiBJRW50cnlbXSA9IFtdLCBlbnRyeSA9IHRoaXMuaGVhZDtcbi8vICAgIHdoaWxlIChlbnRyeSkge1xuLy8gICAgICAgIHMucHVzaCh7IGtleTogZW50cnkua2V5LnRvSlNPTigpLCB2YWx1ZTogZW50cnkudmFsdWUudG9KU09OKCkgfSk7XG4vLyAgICAgICAgZW50cnkgPSBlbnRyeS5uZXdlcjtcbi8vICAgIH1cbi8vICAgIHJldHVybiBzO1xuLy99O1xuXG4vKiogUmV0dXJucyBhIFN0cmluZyByZXByZXNlbnRhdGlvbiAqL1xuTFJVQ2FjaGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzID0gJycsIGVudHJ5ID0gdGhpcy5oZWFkO1xuICAgIHdoaWxlIChlbnRyeSkge1xuICAgICAgICBzICs9IFN0cmluZyhlbnRyeS5rZXkpICsgJzonICsgZW50cnkudmFsdWU7XG4gICAgICAgIGVudHJ5ID0gZW50cnkubmV3ZXI7XG4gICAgICAgIGlmIChlbnRyeSlcbiAgICAgICAgICAgIHMgKz0gJyA8ICc7XG4gICAgfVxuICAgIHJldHVybiBzO1xufTtcblxuLy8gRXhwb3J0IG91cnNlbHZlc1xuLy9pZiAodHlwZW9mIHRoaXMgPT09ICdvYmplY3QnKSB0aGlzLkxSVUNhY2hlID0gTFJVQ2FjaGU7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2xydS50cyJdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7Ozs7OztBQWlCQTs7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBU0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7Ozs7O0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }),
/* 8 */
/* unknown exports provided */
/* all exports used */
/*!************************!*\
  !*** ./src/request.ts ***!
  \************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nexports.__esModule = true;\n__webpack_require__(/*! isomorphic-fetch */ 3);\nfunction createError(status, message) {\n    return {\n        name: \"prismic-request-error\",\n        message: message,\n        status: status\n    };\n}\n// Number of maximum simultaneous connections to the prismic server\nvar MAX_CONNECTIONS = 20;\n// Number of requests currently running (capped by MAX_CONNECTIONS)\nvar running = 0;\n// Requests in queue\nvar queue = [];\nfunction fetchRequest(url, onSuccess, onError) {\n    fetch(url, {\n        headers: {\n            'Accept': 'application/json',\n            'User-Agent': 'Prismic-javascript-kit'\n        }\n    }).then(function (response) {\n        if (~~(response.status / 100 != 2)) {\n            throw createError(response.status, \"Unexpected status code [\" + response.status + \"] on URL \" + url);\n        }\n        else {\n            return response.json().then(function (json) {\n                return {\n                    response: response,\n                    json: json\n                };\n            });\n        }\n    }).then(function (next) {\n        var response = next.response;\n        var json = next.json;\n        var cacheControl = response.headers['cache-control'];\n        var parsedCacheControl = cacheControl ? /max-age=(\\d+)/.exec(cacheControl) : null;\n        var ttl = parsedCacheControl ? parseInt(parsedCacheControl[1], 10) : undefined;\n        onSuccess({ result: json, xhr: response, ttl: ttl });\n    })[\"catch\"](function (error) {\n        onError({ error: error });\n    });\n}\nfunction processQueue() {\n    if (queue.length === 0 || running >= MAX_CONNECTIONS) {\n        return;\n    }\n    running++;\n    var next = queue.shift();\n    fetchRequest(next.url, function (_a) {\n        var result = _a.result, xhr = _a.xhr, ttl = _a.ttl;\n        running--;\n        next.callback(null, result, xhr, ttl);\n        processQueue();\n    }, function (_a) {\n        var error = _a.error;\n        next.callback(error);\n    });\n}\nvar DefaultRequestHandler = (function () {\n    function DefaultRequestHandler() {\n    }\n    DefaultRequestHandler.prototype.request = function (url, cb) {\n        queue.push({\n            'url': url,\n            'callback': cb\n        });\n        processQueue();\n    };\n    return DefaultRequestHandler;\n}());\nexports.DefaultRequestHandler = DefaultRequestHandler;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9yZXF1ZXN0LnRzPzliNTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwiaXNvbW9ycGhpYy1mZXRjaFwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIElSZXF1ZXN0RXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIHN0YXR1czogbnVtYmVyO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVFcnJvcihzdGF0dXM6IG51bWJlciwgbWVzc2FnZTogc3RyaW5nKTogSVJlcXVlc3RFcnJvciB7XG4gIHJldHVybiB7XG4gICAgbmFtZTogXCJwcmlzbWljLXJlcXVlc3QtZXJyb3JcIixcbiAgICBtZXNzYWdlLFxuICAgIHN0YXR1czogc3RhdHVzXG4gIH1cbn1cblxuXG4vLyBOdW1iZXIgb2YgbWF4aW11bSBzaW11bHRhbmVvdXMgY29ubmVjdGlvbnMgdG8gdGhlIHByaXNtaWMgc2VydmVyXG5sZXQgTUFYX0NPTk5FQ1RJT05TOiBudW1iZXIgPSAyMDtcbi8vIE51bWJlciBvZiByZXF1ZXN0cyBjdXJyZW50bHkgcnVubmluZyAoY2FwcGVkIGJ5IE1BWF9DT05ORUNUSU9OUylcbmxldCBydW5uaW5nOiBudW1iZXIgPSAwO1xuLy8gUmVxdWVzdHMgaW4gcXVldWVcbmxldCBxdWV1ZTogYW55W10gID0gW107XG5cbmludGVyZmFjZSBJUmVxdWVzdENhbGxiYWNrIHt9XG5cbmludGVyZmFjZSBJUmVxdWVzdENhbGxiYWNrU3VjY2VzcyBleHRlbmRzIElSZXF1ZXN0Q2FsbGJhY2sge1xuICByZXN1bHQ6IGFueTtcbiAgeGhyOiBhbnk7XG4gIHR0bCA/OiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBJUmVxdWVzdENhbGxiYWNrRmFpbHVyZSBleHRlbmRzIElSZXF1ZXN0Q2FsbGJhY2sge1xuICBlcnJvcjogRXJyb3Jcbn1cblxuXG5mdW5jdGlvbiBmZXRjaFJlcXVlc3QoXG4gIHVybDogc3RyaW5nLFxuICBvblN1Y2Nlc3M6IChfOiBJUmVxdWVzdENhbGxiYWNrU3VjY2VzcykgPT4gdm9pZCxcbiAgb25FcnJvcjogKF86IElSZXF1ZXN0Q2FsbGJhY2tGYWlsdXJlKSA9PiB2b2lkXG4pOiBhbnkge1xuICBmZXRjaCh1cmwsIHtcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgJ1VzZXItQWdlbnQnOiAnUHJpc21pYy1qYXZhc2NyaXB0LWtpdCdcbiAgICB9XG4gIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgaWYgKH5+KHJlc3BvbnNlLnN0YXR1cyAvIDEwMCAhPSAyKSkge1xuICAgICAgdGhyb3cgY3JlYXRlRXJyb3IocmVzcG9uc2Uuc3RhdHVzLCBcIlVuZXhwZWN0ZWQgc3RhdHVzIGNvZGUgW1wiICsgcmVzcG9uc2Uuc3RhdHVzICsgXCJdIG9uIFVSTCBcIiArIHVybCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCkudGhlbihmdW5jdGlvbihqc29uKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlLFxuICAgICAgICAgIGpzb246IGpzb25cbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSkudGhlbihmdW5jdGlvbihuZXh0OiBhbnkpIHtcbiAgICB2YXIgcmVzcG9uc2UgPSBuZXh0LnJlc3BvbnNlO1xuICAgIHZhciBqc29uID0gbmV4dC5qc29uO1xuICAgIHZhciBjYWNoZUNvbnRyb2wgPSByZXNwb25zZS5oZWFkZXJzWydjYWNoZS1jb250cm9sJ107XG4gICAgY29uc3QgcGFyc2VkQ2FjaGVDb250cm9sOiBzdHJpbmdbXSB8IG51bGwgPSBjYWNoZUNvbnRyb2wgPyAvbWF4LWFnZT0oXFxkKykvLmV4ZWMoY2FjaGVDb250cm9sKSA6IG51bGw7XG4gICAgdmFyIHR0bCA9IHBhcnNlZENhY2hlQ29udHJvbCA/IHBhcnNlSW50KHBhcnNlZENhY2hlQ29udHJvbFsxXSwgMTApIDogdW5kZWZpbmVkO1xuICAgIG9uU3VjY2Vzcyh7cmVzdWx0OiBqc29uLCB4aHI6IHJlc3BvbnNlLCB0dGx9IGFzIElSZXF1ZXN0Q2FsbGJhY2tTdWNjZXNzKTtcbiAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yOiBFcnJvcikge1xuICAgIG9uRXJyb3Ioe2Vycm9yfSBhcyBJUmVxdWVzdENhbGxiYWNrRmFpbHVyZSk7XG4gIH0pO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElSZXF1ZXN0SGFuZGxlciB7XG4gIHJlcXVlc3QodXJsOiBTdHJpbmcsIGNiOiAoZXJyb3I6IEVycm9yIHwgbnVsbCwgcmVzdWx0PzogYW55LCB4aHI/OiBhbnkpID0+IHZvaWQpOiB2b2lkXG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NRdWV1ZSgpIHtcbiAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMCB8fCBydW5uaW5nID49IE1BWF9DT05ORUNUSU9OUykge1xuICAgIHJldHVybjtcbiAgfVxuICBydW5uaW5nKys7XG4gIHZhciBuZXh0ID0gcXVldWUuc2hpZnQoKTtcbiAgXG4gIGZldGNoUmVxdWVzdChuZXh0LnVybCxcbiAgICBmdW5jdGlvbih7cmVzdWx0LCB4aHIsIHR0bH06IElSZXF1ZXN0Q2FsbGJhY2tTdWNjZXNzKSB7XG4gICAgICBydW5uaW5nLS07XG4gICAgICBuZXh0LmNhbGxiYWNrKG51bGwsIHJlc3VsdCwgeGhyLCB0dGwpO1xuICAgICAgcHJvY2Vzc1F1ZXVlKCk7XG4gICAgfSxcbiAgICBmdW5jdGlvbih7ZXJyb3J9OiBJUmVxdWVzdENhbGxiYWNrRmFpbHVyZSkge1xuICAgICAgbmV4dC5jYWxsYmFjayhlcnJvcik7XG4gICAgfVxuICApO1xufVxuXG5leHBvcnQgY2xhc3MgRGVmYXVsdFJlcXVlc3RIYW5kbGVyIGltcGxlbWVudHMgSVJlcXVlc3RIYW5kbGVyIHtcbiAgcmVxdWVzdCh1cmw6IFN0cmluZywgY2I6IChlcnJvcjogRXJyb3IgfCBudWxsLCByZXN1bHQ/OiBhbnksIHhocj86IGFueSwgdHRsPzogbnVtYmVyKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgcXVldWUucHVzaCh7XG4gICAgICAndXJsJzogdXJsLFxuICAgICAgJ2NhbGxiYWNrJzogY2JcbiAgICB9KTtcbiAgICBwcm9jZXNzUXVldWUoKTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3JlcXVlc3QudHMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWVBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQUE7QUFRQTtBQVBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQVJBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),
/* 9 */
/* unknown exports provided */
/* all exports used */
/*!*********************************!*\
  !*** ./~/whatwg-fetch/fetch.js ***!
  \*********************************/
/***/ (function(module, exports) {

eval("(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ]\n\n    var isDataView = function(obj) {\n      return obj && DataView.prototype.isPrototypeOf(obj)\n    }\n\n    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1])\n      }, this)\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var oldValue = this.map[name]\n    this.map[name] = oldValue ? oldValue+','+value : value\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name)\n    return this.has(name) ? this.map[name] : null\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value)\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this)\n      }\n    }\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsArrayBuffer(blob)\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsText(blob)\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf)\n    var chars = new Array(view.length)\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i])\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength)\n      view.set(new Uint8Array(buf))\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (!body) {\n        this._bodyText = ''\n      } else if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer)\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer])\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body)\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      }\n    }\n\n    this.text = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = String(input)\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, { body: this._bodyInit })\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers()\n    rawHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        headers.append(key, value)\n      }\n    })\n    return headers\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = 'status' in options ? options.status : 200\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n    this.headers = new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init)\n      var xhr = new XMLHttpRequest()\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        }\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL34vd2hhdHdnLWZldGNoL2ZldGNoLmpzPzFjMjAiXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKHNlbGYpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGlmIChzZWxmLmZldGNoKSB7XG4gICAgcmV0dXJuXG4gIH1cblxuICB2YXIgc3VwcG9ydCA9IHtcbiAgICBzZWFyY2hQYXJhbXM6ICdVUkxTZWFyY2hQYXJhbXMnIGluIHNlbGYsXG4gICAgaXRlcmFibGU6ICdTeW1ib2wnIGluIHNlbGYgJiYgJ2l0ZXJhdG9yJyBpbiBTeW1ib2wsXG4gICAgYmxvYjogJ0ZpbGVSZWFkZXInIGluIHNlbGYgJiYgJ0Jsb2InIGluIHNlbGYgJiYgKGZ1bmN0aW9uKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbmV3IEJsb2IoKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgIH0pKCksXG4gICAgZm9ybURhdGE6ICdGb3JtRGF0YScgaW4gc2VsZixcbiAgICBhcnJheUJ1ZmZlcjogJ0FycmF5QnVmZmVyJyBpbiBzZWxmXG4gIH1cblxuICBpZiAoc3VwcG9ydC5hcnJheUJ1ZmZlcikge1xuICAgIHZhciB2aWV3Q2xhc3NlcyA9IFtcbiAgICAgICdbb2JqZWN0IEludDhBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgVWludDhBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgVWludDhDbGFtcGVkQXJyYXldJyxcbiAgICAgICdbb2JqZWN0IEludDE2QXJyYXldJyxcbiAgICAgICdbb2JqZWN0IFVpbnQxNkFycmF5XScsXG4gICAgICAnW29iamVjdCBJbnQzMkFycmF5XScsXG4gICAgICAnW29iamVjdCBVaW50MzJBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgRmxvYXQzMkFycmF5XScsXG4gICAgICAnW29iamVjdCBGbG9hdDY0QXJyYXldJ1xuICAgIF1cblxuICAgIHZhciBpc0RhdGFWaWV3ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIERhdGFWaWV3LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKG9iailcbiAgICB9XG5cbiAgICB2YXIgaXNBcnJheUJ1ZmZlclZpZXcgPSBBcnJheUJ1ZmZlci5pc1ZpZXcgfHwgZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIHZpZXdDbGFzc2VzLmluZGV4T2YoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikpID4gLTFcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBub3JtYWxpemVOYW1lKG5hbWUpIHtcbiAgICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICBuYW1lID0gU3RyaW5nKG5hbWUpXG4gICAgfVxuICAgIGlmICgvW15hLXowLTlcXC0jJCUmJyorLlxcXl9gfH5dL2kudGVzdChuYW1lKSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBjaGFyYWN0ZXIgaW4gaGVhZGVyIGZpZWxkIG5hbWUnKVxuICAgIH1cbiAgICByZXR1cm4gbmFtZS50b0xvd2VyQ2FzZSgpXG4gIH1cblxuICBmdW5jdGlvbiBub3JtYWxpemVWYWx1ZSh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICB2YWx1ZSA9IFN0cmluZyh2YWx1ZSlcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlXG4gIH1cblxuICAvLyBCdWlsZCBhIGRlc3RydWN0aXZlIGl0ZXJhdG9yIGZvciB0aGUgdmFsdWUgbGlzdFxuICBmdW5jdGlvbiBpdGVyYXRvckZvcihpdGVtcykge1xuICAgIHZhciBpdGVyYXRvciA9IHtcbiAgICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBpdGVtcy5zaGlmdCgpXG4gICAgICAgIHJldHVybiB7ZG9uZTogdmFsdWUgPT09IHVuZGVmaW5lZCwgdmFsdWU6IHZhbHVlfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXBwb3J0Lml0ZXJhYmxlKSB7XG4gICAgICBpdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvclxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpdGVyYXRvclxuICB9XG5cbiAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gICAgdGhpcy5tYXAgPSB7fVxuXG4gICAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgICBoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgdmFsdWUpXG4gICAgICB9LCB0aGlzKVxuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShoZWFkZXJzKSkge1xuICAgICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKGhlYWRlcikge1xuICAgICAgICB0aGlzLmFwcGVuZChoZWFkZXJbMF0sIGhlYWRlclsxXSlcbiAgICAgIH0sIHRoaXMpXG4gICAgfSBlbHNlIGlmIChoZWFkZXJzKSB7XG4gICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSlcbiAgICAgIH0sIHRoaXMpXG4gICAgfVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICAgIHZhbHVlID0gbm9ybWFsaXplVmFsdWUodmFsdWUpXG4gICAgdmFyIG9sZFZhbHVlID0gdGhpcy5tYXBbbmFtZV1cbiAgICB0aGlzLm1hcFtuYW1lXSA9IG9sZFZhbHVlID8gb2xkVmFsdWUrJywnK3ZhbHVlIDogdmFsdWVcbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlWydkZWxldGUnXSA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBkZWxldGUgdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV1cbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICAgIHJldHVybiB0aGlzLmhhcyhuYW1lKSA/IHRoaXMubWFwW25hbWVdIDogbnVsbFxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24obmFtZSkge1xuICAgIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzLm1hcCkge1xuICAgICAgaWYgKHRoaXMubWFwLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpcy5tYXBbbmFtZV0sIG5hbWUsIHRoaXMpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpdGVtcyA9IFtdXG4gICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7IGl0ZW1zLnB1c2gobmFtZSkgfSlcbiAgICByZXR1cm4gaXRlcmF0b3JGb3IoaXRlbXMpXG4gIH1cblxuICBIZWFkZXJzLnByb3RvdHlwZS52YWx1ZXMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXRlbXMgPSBbXVxuICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSkgeyBpdGVtcy5wdXNoKHZhbHVlKSB9KVxuICAgIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmVudHJpZXMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXRlbXMgPSBbXVxuICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkgeyBpdGVtcy5wdXNoKFtuYW1lLCB2YWx1ZV0pIH0pXG4gICAgcmV0dXJuIGl0ZXJhdG9yRm9yKGl0ZW1zKVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgICBIZWFkZXJzLnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdID0gSGVhZGVycy5wcm90b3R5cGUuZW50cmllc1xuICB9XG5cbiAgZnVuY3Rpb24gY29uc3VtZWQoYm9keSkge1xuICAgIGlmIChib2R5LmJvZHlVc2VkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJykpXG4gICAgfVxuICAgIGJvZHkuYm9keVVzZWQgPSB0cnVlXG4gIH1cblxuICBmdW5jdGlvbiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKHJlYWRlci5yZXN1bHQpXG4gICAgICB9XG4gICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QocmVhZGVyLmVycm9yKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBmdW5jdGlvbiByZWFkQmxvYkFzQXJyYXlCdWZmZXIoYmxvYikge1xuICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgdmFyIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKVxuICAgIHJldHVybiBwcm9taXNlXG4gIH1cblxuICBmdW5jdGlvbiByZWFkQmxvYkFzVGV4dChibG9iKSB7XG4gICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICB2YXIgcHJvbWlzZSA9IGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gICAgcmVhZGVyLnJlYWRBc1RleHQoYmxvYilcbiAgICByZXR1cm4gcHJvbWlzZVxuICB9XG5cbiAgZnVuY3Rpb24gcmVhZEFycmF5QnVmZmVyQXNUZXh0KGJ1Zikge1xuICAgIHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmKVxuICAgIHZhciBjaGFycyA9IG5ldyBBcnJheSh2aWV3Lmxlbmd0aClcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmlldy5sZW5ndGg7IGkrKykge1xuICAgICAgY2hhcnNbaV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHZpZXdbaV0pXG4gICAgfVxuICAgIHJldHVybiBjaGFycy5qb2luKCcnKVxuICB9XG5cbiAgZnVuY3Rpb24gYnVmZmVyQ2xvbmUoYnVmKSB7XG4gICAgaWYgKGJ1Zi5zbGljZSkge1xuICAgICAgcmV0dXJuIGJ1Zi5zbGljZSgwKVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1Zi5ieXRlTGVuZ3RoKVxuICAgICAgdmlldy5zZXQobmV3IFVpbnQ4QXJyYXkoYnVmKSlcbiAgICAgIHJldHVybiB2aWV3LmJ1ZmZlclxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIEJvZHkoKSB7XG4gICAgdGhpcy5ib2R5VXNlZCA9IGZhbHNlXG5cbiAgICB0aGlzLl9pbml0Qm9keSA9IGZ1bmN0aW9uKGJvZHkpIHtcbiAgICAgIHRoaXMuX2JvZHlJbml0ID0gYm9keVxuICAgICAgaWYgKCFib2R5KSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gJydcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmJsb2IgJiYgQmxvYi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5QmxvYiA9IGJvZHlcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5mb3JtRGF0YSAmJiBGb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5Rm9ybURhdGEgPSBib2R5XG4gICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHkudG9TdHJpbmcoKVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIHN1cHBvcnQuYmxvYiAmJiBpc0RhdGFWaWV3KGJvZHkpKSB7XG4gICAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkuYnVmZmVyKVxuICAgICAgICAvLyBJRSAxMC0xMSBjYW4ndCBoYW5kbGUgYSBEYXRhVmlldyBib2R5LlxuICAgICAgICB0aGlzLl9ib2R5SW5pdCA9IG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIChBcnJheUJ1ZmZlci5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSB8fCBpc0FycmF5QnVmZmVyVmlldyhib2R5KSkpIHtcbiAgICAgICAgdGhpcy5fYm9keUFycmF5QnVmZmVyID0gYnVmZmVyQ2xvbmUoYm9keSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigndW5zdXBwb3J0ZWQgQm9keUluaXQgdHlwZScpXG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICd0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLTgnKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlCbG9iICYmIHRoaXMuX2JvZHlCbG9iLnR5cGUpIHtcbiAgICAgICAgICB0aGlzLmhlYWRlcnMuc2V0KCdjb250ZW50LXR5cGUnLCB0aGlzLl9ib2R5QmxvYi50eXBlKVxuICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCcpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc3VwcG9ydC5ibG9iKSB7XG4gICAgICB0aGlzLmJsb2IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fYm9keUJsb2IpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlCbG9iKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyBibG9iJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5VGV4dF0pKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYXJyYXlCdWZmZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICAgIHJldHVybiBjb25zdW1lZCh0aGlzKSB8fCBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUFycmF5QnVmZmVyKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMudGV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgIHJldHVybiByZWFkQmxvYkFzVGV4dCh0aGlzLl9ib2R5QmxvYilcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVhZEFycmF5QnVmZmVyQXNUZXh0KHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgdGV4dCcpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXBwb3J0LmZvcm1EYXRhKSB7XG4gICAgICB0aGlzLmZvcm1EYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKGRlY29kZSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmpzb24gPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKEpTT04ucGFyc2UpXG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8vIEhUVFAgbWV0aG9kcyB3aG9zZSBjYXBpdGFsaXphdGlvbiBzaG91bGQgYmUgbm9ybWFsaXplZFxuICB2YXIgbWV0aG9kcyA9IFsnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUE9TVCcsICdQVVQnXVxuXG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZU1ldGhvZChtZXRob2QpIHtcbiAgICB2YXIgdXBjYXNlZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpXG4gICAgcmV0dXJuIChtZXRob2RzLmluZGV4T2YodXBjYXNlZCkgPiAtMSkgPyB1cGNhc2VkIDogbWV0aG9kXG4gIH1cblxuICBmdW5jdGlvbiBSZXF1ZXN0KGlucHV0LCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge31cbiAgICB2YXIgYm9keSA9IG9wdGlvbnMuYm9keVxuXG4gICAgaWYgKGlucHV0IGluc3RhbmNlb2YgUmVxdWVzdCkge1xuICAgICAgaWYgKGlucHV0LmJvZHlVc2VkKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FscmVhZHkgcmVhZCcpXG4gICAgICB9XG4gICAgICB0aGlzLnVybCA9IGlucHV0LnVybFxuICAgICAgdGhpcy5jcmVkZW50aWFscyA9IGlucHV0LmNyZWRlbnRpYWxzXG4gICAgICBpZiAoIW9wdGlvbnMuaGVhZGVycykge1xuICAgICAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhpbnB1dC5oZWFkZXJzKVxuICAgICAgfVxuICAgICAgdGhpcy5tZXRob2QgPSBpbnB1dC5tZXRob2RcbiAgICAgIHRoaXMubW9kZSA9IGlucHV0Lm1vZGVcbiAgICAgIGlmICghYm9keSAmJiBpbnB1dC5fYm9keUluaXQgIT0gbnVsbCkge1xuICAgICAgICBib2R5ID0gaW5wdXQuX2JvZHlJbml0XG4gICAgICAgIGlucHV0LmJvZHlVc2VkID0gdHJ1ZVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVybCA9IFN0cmluZyhpbnB1dClcbiAgICB9XG5cbiAgICB0aGlzLmNyZWRlbnRpYWxzID0gb3B0aW9ucy5jcmVkZW50aWFscyB8fCB0aGlzLmNyZWRlbnRpYWxzIHx8ICdvbWl0J1xuICAgIGlmIChvcHRpb25zLmhlYWRlcnMgfHwgIXRoaXMuaGVhZGVycykge1xuICAgICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICAgIH1cbiAgICB0aGlzLm1ldGhvZCA9IG5vcm1hbGl6ZU1ldGhvZChvcHRpb25zLm1ldGhvZCB8fCB0aGlzLm1ldGhvZCB8fCAnR0VUJylcbiAgICB0aGlzLm1vZGUgPSBvcHRpb25zLm1vZGUgfHwgdGhpcy5tb2RlIHx8IG51bGxcbiAgICB0aGlzLnJlZmVycmVyID0gbnVsbFxuXG4gICAgaWYgKCh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykgJiYgYm9keSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQm9keSBub3QgYWxsb3dlZCBmb3IgR0VUIG9yIEhFQUQgcmVxdWVzdHMnKVxuICAgIH1cbiAgICB0aGlzLl9pbml0Qm9keShib2R5KVxuICB9XG5cbiAgUmVxdWVzdC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFJlcXVlc3QodGhpcywgeyBib2R5OiB0aGlzLl9ib2R5SW5pdCB9KVxuICB9XG5cbiAgZnVuY3Rpb24gZGVjb2RlKGJvZHkpIHtcbiAgICB2YXIgZm9ybSA9IG5ldyBGb3JtRGF0YSgpXG4gICAgYm9keS50cmltKCkuc3BsaXQoJyYnKS5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGVzKSB7XG4gICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgdmFyIHNwbGl0ID0gYnl0ZXMuc3BsaXQoJz0nKVxuICAgICAgICB2YXIgbmFtZSA9IHNwbGl0LnNoaWZ0KCkucmVwbGFjZSgvXFwrL2csICcgJylcbiAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgIGZvcm0uYXBwZW5kKGRlY29kZVVSSUNvbXBvbmVudChuYW1lKSwgZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBmb3JtXG4gIH1cblxuICBmdW5jdGlvbiBwYXJzZUhlYWRlcnMocmF3SGVhZGVycykge1xuICAgIHZhciBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKVxuICAgIHJhd0hlYWRlcnMuc3BsaXQoL1xccj9cXG4vKS5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIHZhciBwYXJ0cyA9IGxpbmUuc3BsaXQoJzonKVxuICAgICAgdmFyIGtleSA9IHBhcnRzLnNoaWZ0KCkudHJpbSgpXG4gICAgICBpZiAoa2V5KSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHBhcnRzLmpvaW4oJzonKS50cmltKClcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoa2V5LCB2YWx1ZSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBoZWFkZXJzXG4gIH1cblxuICBCb2R5LmNhbGwoUmVxdWVzdC5wcm90b3R5cGUpXG5cbiAgZnVuY3Rpb24gUmVzcG9uc2UoYm9keUluaXQsIG9wdGlvbnMpIHtcbiAgICBpZiAoIW9wdGlvbnMpIHtcbiAgICAgIG9wdGlvbnMgPSB7fVxuICAgIH1cblxuICAgIHRoaXMudHlwZSA9ICdkZWZhdWx0J1xuICAgIHRoaXMuc3RhdHVzID0gJ3N0YXR1cycgaW4gb3B0aW9ucyA/IG9wdGlvbnMuc3RhdHVzIDogMjAwXG4gICAgdGhpcy5vayA9IHRoaXMuc3RhdHVzID49IDIwMCAmJiB0aGlzLnN0YXR1cyA8IDMwMFxuICAgIHRoaXMuc3RhdHVzVGV4dCA9ICdzdGF0dXNUZXh0JyBpbiBvcHRpb25zID8gb3B0aW9ucy5zdGF0dXNUZXh0IDogJ09LJ1xuICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycylcbiAgICB0aGlzLnVybCA9IG9wdGlvbnMudXJsIHx8ICcnXG4gICAgdGhpcy5faW5pdEJvZHkoYm9keUluaXQpXG4gIH1cblxuICBCb2R5LmNhbGwoUmVzcG9uc2UucHJvdG90eXBlKVxuXG4gIFJlc3BvbnNlLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgUmVzcG9uc2UodGhpcy5fYm9keUluaXQsIHtcbiAgICAgIHN0YXR1czogdGhpcy5zdGF0dXMsXG4gICAgICBzdGF0dXNUZXh0OiB0aGlzLnN0YXR1c1RleHQsXG4gICAgICBoZWFkZXJzOiBuZXcgSGVhZGVycyh0aGlzLmhlYWRlcnMpLFxuICAgICAgdXJsOiB0aGlzLnVybFxuICAgIH0pXG4gIH1cblxuICBSZXNwb25zZS5lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciByZXNwb25zZSA9IG5ldyBSZXNwb25zZShudWxsLCB7c3RhdHVzOiAwLCBzdGF0dXNUZXh0OiAnJ30pXG4gICAgcmVzcG9uc2UudHlwZSA9ICdlcnJvcidcbiAgICByZXR1cm4gcmVzcG9uc2VcbiAgfVxuXG4gIHZhciByZWRpcmVjdFN0YXR1c2VzID0gWzMwMSwgMzAyLCAzMDMsIDMwNywgMzA4XVxuXG4gIFJlc3BvbnNlLnJlZGlyZWN0ID0gZnVuY3Rpb24odXJsLCBzdGF0dXMpIHtcbiAgICBpZiAocmVkaXJlY3RTdGF0dXNlcy5pbmRleE9mKHN0YXR1cykgPT09IC0xKSB7XG4gICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW52YWxpZCBzdGF0dXMgY29kZScpXG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShudWxsLCB7c3RhdHVzOiBzdGF0dXMsIGhlYWRlcnM6IHtsb2NhdGlvbjogdXJsfX0pXG4gIH1cblxuICBzZWxmLkhlYWRlcnMgPSBIZWFkZXJzXG4gIHNlbGYuUmVxdWVzdCA9IFJlcXVlc3RcbiAgc2VsZi5SZXNwb25zZSA9IFJlc3BvbnNlXG5cbiAgc2VsZi5mZXRjaCA9IGZ1bmN0aW9uKGlucHV0LCBpbml0KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgUmVxdWVzdChpbnB1dCwgaW5pdClcbiAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKVxuXG4gICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICAgIHN0YXR1czogeGhyLnN0YXR1cyxcbiAgICAgICAgICBzdGF0dXNUZXh0OiB4aHIuc3RhdHVzVGV4dCxcbiAgICAgICAgICBoZWFkZXJzOiBwYXJzZUhlYWRlcnMoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpIHx8ICcnKVxuICAgICAgICB9XG4gICAgICAgIG9wdGlvbnMudXJsID0gJ3Jlc3BvbnNlVVJMJyBpbiB4aHIgPyB4aHIucmVzcG9uc2VVUkwgOiBvcHRpb25zLmhlYWRlcnMuZ2V0KCdYLVJlcXVlc3QtVVJMJylcbiAgICAgICAgdmFyIGJvZHkgPSAncmVzcG9uc2UnIGluIHhociA/IHhoci5yZXNwb25zZSA6IHhoci5yZXNwb25zZVRleHRcbiAgICAgICAgcmVzb2x2ZShuZXcgUmVzcG9uc2UoYm9keSwgb3B0aW9ucykpXG4gICAgICB9XG5cbiAgICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChuZXcgVHlwZUVycm9yKCdOZXR3b3JrIHJlcXVlc3QgZmFpbGVkJykpXG4gICAgICB9XG5cbiAgICAgIHhoci5vbnRpbWVvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSlcbiAgICAgIH1cblxuICAgICAgeGhyLm9wZW4ocmVxdWVzdC5tZXRob2QsIHJlcXVlc3QudXJsLCB0cnVlKVxuXG4gICAgICBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ2luY2x1ZGUnKSB7XG4gICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlXG4gICAgICB9XG5cbiAgICAgIGlmICgncmVzcG9uc2VUeXBlJyBpbiB4aHIgJiYgc3VwcG9ydC5ibG9iKSB7XG4gICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYmxvYidcbiAgICAgIH1cblxuICAgICAgcmVxdWVzdC5oZWFkZXJzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIobmFtZSwgdmFsdWUpXG4gICAgICB9KVxuXG4gICAgICB4aHIuc2VuZCh0eXBlb2YgcmVxdWVzdC5fYm9keUluaXQgPT09ICd1bmRlZmluZWQnID8gbnVsbCA6IHJlcXVlc3QuX2JvZHlJbml0KVxuICAgIH0pXG4gIH1cbiAgc2VsZi5mZXRjaC5wb2x5ZmlsbCA9IHRydWVcbn0pKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB0aGlzKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi93aGF0d2ctZmV0Y2gvZmV0Y2guanNcbi8vIG1vZHVsZSBpZCA9IDlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),
/* 10 */
/* unknown exports provided */
/* all exports used */
/*!****************************!*\
  !*** multi ./src/index.ts ***!
  \****************************/
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! /development/workspace/javascript-kit-v2/src/index.ts */2);


/***/ })
/******/ ]);
});